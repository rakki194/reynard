/**
 * ðŸº EXPLOIT RECOMMENDATIONS
 *
 * *snarls with predatory focus* Generates security recommendations
 * based on exploit results and vulnerability types.
 */

/**
 * Generate exploit-specific recommendations
 */
export function generateExploitRecommendations(exploitModule: string, vulnerabilityCount: number): string[] {
  if (vulnerabilityCount === 0) {
    return [`âœ… ${exploitModule} - No vulnerabilities found`];
  }

  const recommendations: string[] = [];

  if (exploitModule.includes("jwt")) {
    recommendations.push("ðŸ” JWT Security Recommendations:");
    recommendations.push("  â€¢ Use persistent, secure secret keys");
    recommendations.push("  â€¢ Implement proper token rotation");
    recommendations.push("  â€¢ Add token validation middleware");
  }

  if (exploitModule.includes("sql")) {
    recommendations.push("ðŸ›¡ï¸ SQL Injection Prevention:");
    recommendations.push("  â€¢ Use parameterized queries exclusively");
    recommendations.push("  â€¢ Implement input validation");
    recommendations.push("  â€¢ Add database access controls");
  }

  if (exploitModule.includes("path")) {
    recommendations.push("ðŸ“ Path Traversal Prevention:");
    recommendations.push("  â€¢ Implement proper path validation");
    recommendations.push("  â€¢ Use allowlists for file access");
    recommendations.push("  â€¢ Add file system access controls");
  }

  if (exploitModule.includes("cors")) {
    recommendations.push("ðŸŒ CORS Security:");
    recommendations.push("  â€¢ Configure specific allowed origins");
    recommendations.push("  â€¢ Avoid wildcard origins");
    recommendations.push("  â€¢ Implement proper CORS headers");
  }

  if (exploitModule.includes("rate")) {
    recommendations.push("âš¡ Rate Limiting:");
    recommendations.push("  â€¢ Implement proper rate limiting");
    recommendations.push("  â€¢ Add IP-based restrictions");
    recommendations.push("  â€¢ Monitor for bypass attempts");
  }

  return recommendations;
}

/**
 * Determine severity based on vulnerability count
 */
export function determineSeverity(count: number): "LOW" | "MEDIUM" | "HIGH" | "CRITICAL" {
  if (count >= 5) return "CRITICAL";
  if (count >= 3) return "HIGH";
  if (count >= 1) return "MEDIUM";
  return "LOW";
}
