<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Model Management System - Reynard Documentation Test</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../highlight.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <nav class="docs-nav">
    <div class="nav-brand"><a href="../index.html">Reynard Documentation Test</a></div>
    <div class="nav-links"><a href="../index.html">Home</a><a href="../api.html">API Reference</a></div>
  </nav>
  <main class="docs-main">
    <div class="docs-content">
      <h1>Model Management System</h1>
      <div class="markdown-content"><h1>Model Management System</h1>
<p>This document describes the comprehensive model management system in the Reynard framework,<br>which provides administrators with a centralized interface for configuring and<br>managing all AI models used by Reynard applications through the <code>reynard-model-management</code> package.</p>
<h2>Overview</h2>
<p>The Model Management system is an admin-only feature that allows administrators<br>to:</p>
<ul>
<li>View and manage all registered models (JTP2, WDv3, Florence2, YOLO, etc.)</li>
<li>Configure model parameters and settings</li>
<li>Monitor download progress and status</li>
<li>Manage HuggingFace cache</li>
<li>Configure Ollama models</li>
<li>Start and manage model downloads</li>
</ul>
<h2>Access Control</h2>
<p>The Model Management interface is only accessible to users with the <code>admin</code><br>role. Regular users and guests cannot access this functionality.</p>
<h3>Accessing Model Management</h3>
<ol>
<li>Log in as an administrator</li>
<li>Open the Settings panel</li>
<li>Look for the &quot;Model Management&quot; tab (only visible to admins)</li>
<li>Click on the tab to access the model management interface</li>
</ol>
<h2>Interface Overview</h2>
<p>The Model Management interface is organized into six main tabs:</p>
<h3>1. Overview Tab</h3>
<p>The Overview tab provides a high-level summary of all models and system status:</p>
<ul>
<li><strong>Total Models</strong>: Number of registered models</li>
<li><strong>Downloaded</strong>: Number of models ready to use</li>
<li><strong>Ollama Models</strong>: Number of local Ollama models</li>
<li><strong>Cache Size</strong>: Total size of HuggingFace cache</li>
</ul>
<p>Quick action buttons allow administrators to:</p>
<ul>
<li>Refresh all data</li>
<li>Navigate to download management</li>
<li>Access cache management</li>
</ul>
<h3>2. Caption Models Tab</h3>
<p>This tab provides configuration options for caption generation models:</p>
<h4>JTP2 Configuration</h4>
<ul>
<li><strong>Threshold</strong>: Confidence threshold for tag inclusion (0.0 to 1.0)</li>
<li><strong>Force CPU</strong>: Force JTP2 to use CPU instead of GPU</li>
<li><strong>Model Path</strong>: Path to JTP2 model file</li>
<li><strong>Tags Path</strong>: Path to JTP2 tags file</li>
</ul>
<h4>WDv3 Configuration</h4>
<ul>
<li><strong>Model Architecture</strong>: Select from ViT, SwinV2, ConvNeXT, or ConvNeXTv2</li>
<li><strong>General Threshold</strong>: Confidence threshold for general tags (0.0 to 1.0)</li>
<li><strong>Character Threshold</strong>: Confidence threshold for character tags (0.0 to 1.0)</li>
<li><strong>Force CPU</strong>: Force WDv3 to use CPU instead of GPU</li>
</ul>
<h4>Florence2 Configuration</h4>
<ul>
<li><strong>Model Variant</strong>: Select from various Florence2 model variants</li>
<li><strong>Max Tokens</strong>: Maximum number of tokens for generation (1-512)</li>
<li><strong>Use GPU</strong>: Enable/disable GPU acceleration</li>
<li><strong>Precision</strong>: Select precision mode (FP16, FP32, BF16)</li>
</ul>
<h3>3. Detection Models Tab</h3>
<p>This tab manages object detection and vision models:</p>
<h4>YOLO Configuration</h4>
<ul>
<li><strong>Model Size</strong>: Select from Nano, Small, Medium, Large, or Extra Large</li>
<li><strong>Confidence Threshold</strong>: Detection confidence threshold (0.0 to 1.0)</li>
<li><strong>IoU Threshold</strong>: Intersection over Union threshold (0.0 to 1.0)</li>
</ul>
<h4>Detection Models Status</h4>
<p>Shows the status of all registered detection models:</p>
<ul>
<li>Model information and description</li>
<li>Download status and progress</li>
<li>Download/retry buttons for failed downloads</li>
</ul>
<h3>4. Ollama Models Tab</h3>
<p>This tab manages local Ollama models:</p>
<h4>Ollama Service Status</h4>
<ul>
<li><strong>Service Status</strong>: Shows if Ollama service is available</li>
<li><strong>Assistant Availability</strong>: Indicates if the assistant is ready</li>
</ul>
<h4>Installed Ollama Models</h4>
<p>Lists all locally installed Ollama models with:</p>
<ul>
<li>Model name and size</li>
<li>Last modification date</li>
<li>Model digest</li>
</ul>
<h4>Pull New Model</h4>
<p>Allows administrators to pull new models from the Ollama registry:</p>
<ul>
<li>Enter model name (e.g., <code>llama2:7b</code>)</li>
<li>Click &quot;Pull Model&quot; to start download</li>
</ul>
<h3>5. HF Cache Tab</h3>
<p>This tab manages the HuggingFace cache:</p>
<h4>Cache Information</h4>
<ul>
<li><strong>Cache Directory</strong>: Path to the HF cache</li>
<li><strong>Total Size</strong>: Total size of cached models</li>
<li><strong>Model Count</strong>: Number of cached models</li>
</ul>
<h4>Cache Actions</h4>
<ul>
<li><strong>Refresh</strong>: Update cache information</li>
<li><strong>Clear Cache</strong>: Remove all cached models (use with caution)</li>
</ul>
<h4>Cached Models</h4>
<p>Lists all models in the HF cache with:</p>
<ul>
<li>Model name and size</li>
<li>Last accessed date</li>
</ul>
<h3>6. Downloads Tab</h3>
<p>This tab provides detailed download management:</p>
<h4>Model Download Status</h4>
<p>For each registered model, shows:</p>
<ul>
<li>Model information and description</li>
<li>Repository ID</li>
<li>Estimated size</li>
<li>Current download status</li>
<li>Progress bar and percentage</li>
<li>Download speed and ETA</li>
<li>Error messages (if any)</li>
</ul>
<h4>Download Actions</h4>
<ul>
<li><strong>Download</strong>: Start download for models not yet downloaded</li>
<li><strong>Retry</strong>: Retry failed downloads</li>
<li><strong>Refresh Status</strong>: Update all download statuses</li>
</ul>
<h2>Model Types</h2>
<p>The system supports several types of models:</p>
<h3>Caption Generators and Text LLMs</h3>
<ul>
<li><strong>JTP2</strong>: Joint Tagger Project for specialized tagging</li>
<li><strong>WDv3</strong>: WD-1.4 Tagger v3 for general purpose tagging</li>
<li><strong>Florence2</strong>: Microsoft&#39;s vision-language model</li>
<li><strong>DreamOn (Diffusion LLM)</strong>: Diffusion-based text LLM supporting infilling and<br>generation</li>
<li><strong>LLaDA (Diffusion LLM)</strong>: Diffusion-based text LLM with streaming generation</li>
<li><strong>JoyCaption</strong>: Large language model for image captioning</li>
</ul>
<h3>Detection Models</h3>
<ul>
<li><strong>YOLO</strong>: Object detection models</li>
<li><strong>Watermark Detection</strong>: YOLO and OWLv2 models for watermark detection</li>
</ul>
<h3>Local Models</h3>
<ul>
<li><strong>Ollama Models</strong>: Locally hosted language models</li>
</ul>
<h3>Diffusion LLMs</h3>
<p>These are registered under a dedicated type (e.g., <code>diffusion_lm</code>) and are<br>available for download via the unified model download manager. In the UI,<br>DreamOn and LLaDA appear with their IDs and can be loaded from the Diffusion LLM<br>panels or from admin-only model loading routes.</p>
<p>Admin endpoints include:</p>
<ul>
<li><code>GET /api/diffusion/models</code></li>
<li><code>POST /api/diffusion/models/{model_id}/load</code></li>
</ul>
<h2>Configuration Management</h2>
<h3>Model Configuration Management</h3>
<p>Each model type has specific configuration options that can be adjusted:</p>
<ol>
<li>Navigate to the appropriate tab (Caption Models, Detection Models)</li>
<li>Modify the desired settings</li>
<li>Click the &quot;Update [Model] Config&quot; button</li>
<li>The system will apply the changes and show a success notification</li>
</ol>
<h3>Environment Variables</h3>
<p>Some model configurations can also be controlled via environment variables:</p>
<ul>
<li><code>DISABLE_MODEL_DOWNLOADS</code>: Disable all model downloads</li>
<li><code>HF_HOME</code>: Set HuggingFace cache directory</li>
<li><code>HF_CACHE</code>: Alternative HF cache directory</li>
</ul>
<h2>Download Management</h2>
<h3>Starting Downloads</h3>
<ol>
<li>Navigate to the Downloads tab</li>
<li>Find the model you want to download</li>
<li>Click the &quot;Download&quot; button</li>
<li>Monitor progress in the status section</li>
</ol>
<h3>Download Status</h3>
<p>Downloads can have the following statuses:</p>
<ul>
<li><strong>not_started</strong>: Model not yet downloaded</li>
<li><strong>downloading</strong>: Currently being downloaded</li>
<li><strong>completed</strong>: Successfully downloaded</li>
<li><strong>failed</strong>: Download failed</li>
<li><strong>disabled</strong>: Downloads disabled by configuration</li>
</ul>
<h3>Progress Tracking</h3>
<p>During downloads, the system shows:</p>
<ul>
<li>Progress bar with percentage</li>
<li>Downloaded size vs total size</li>
<li>Download speed</li>
<li>Estimated time remaining</li>
</ul>
<h2>Cache Management</h2>
<h3>HF Cache Storage</h3>
<p>The HF cache stores downloaded models for reuse:</p>
<ul>
<li><strong>Location</strong>: Configured via <code>HF_HOME</code> or <code>HF_CACHE</code> environment variables</li>
<li><strong>Structure</strong>: Organized by model repository</li>
<li><strong>Persistence</strong>: Survives application restarts</li>
</ul>
<h3>Cache Operations</h3>
<ul>
<li><strong>View</strong>: See cache size and contents</li>
<li><strong>Clear</strong>: Remove all cached models (frees disk space)</li>
<li><strong>Refresh</strong>: Update cache information</li>
</ul>
<h2>Troubleshooting</h2>
<h3>Common Issues</h3>
<h4>Model Downloads Fail</h4>
<ol>
<li>Check if <code>DISABLE_MODEL_DOWNLOADS</code> is set</li>
<li>Verify internet connectivity</li>
<li>Check available disk space</li>
<li>Review error messages in the Downloads tab</li>
</ol>
<h4>Ollama Service Unavailable</h4>
<ol>
<li>Ensure Ollama is installed and running</li>
<li>Check Ollama service status</li>
<li>Verify network connectivity to Ollama</li>
</ol>
<h4>Configuration Not Applied</h4>
<ol>
<li>Check for error messages in notifications</li>
<li>Verify admin permissions</li>
<li>Check backend logs for errors</li>
</ol>
<h3>Error Messages</h3>
<p>Common error messages and solutions:</p>
<ul>
<li><strong>&quot;Model downloads are disabled&quot;</strong>: Set <code>DISABLE_MODEL_DOWNLOADS=false</code></li>
<li><strong>&quot;Ollama service not available&quot;</strong>: Start Ollama service</li>
<li><strong>&quot;Failed to update config&quot;</strong>: Check backend logs for details</li>
</ul>
<h2>Best Practices</h2>
<h3>Model Management</h3>
<ol>
<li><strong>Monitor Cache Size</strong>: Regularly check HF cache size to prevent disk space<br>issues</li>
<li><strong>Test Configurations</strong>: Test model configurations before applying to<br>production</li>
<li><strong>Backup Configurations</strong>: Document custom configurations for recovery</li>
<li><strong>Monitor Downloads</strong>: Watch download progress for large models</li>
</ol>
<h3>Performance</h3>
<ol>
<li><strong>GPU Usage</strong>: Enable GPU acceleration when available for better performance</li>
<li><strong>Model Selection</strong>: Choose appropriate model sizes for your use case</li>
<li><strong>Cache Management</strong>: Keep frequently used models in cache</li>
<li><strong>Resource Monitoring</strong>: Monitor system resources during model operations</li>
</ol>
<h3>Security</h3>
<ol>
<li><strong>Admin Access</strong>: Restrict model management to trusted administrators</li>
<li><strong>Network Security</strong>: Ensure secure connections for model downloads</li>
<li><strong>Model Validation</strong>: Verify model sources and integrity</li>
<li><strong>Access Logging</strong>: Monitor model management activities</li>
</ol>
<h2>API Reference</h2>
<p>The Model Management system provides several API endpoints:</p>
<h3>Model Registry</h3>
<ul>
<li><code>GET /api/model-registry</code>: Get all registered models</li>
<li><code>GET /api/model-download-status/{model_id}</code>: Get download status</li>
<li><code>POST /api/model-download/{model_id}/start</code>: Start model download</li>
</ul>
<h3>HuggingFace Cache</h3>
<ul>
<li><code>GET /api/hf-cache/info</code>: Get cache information</li>
<li><code>POST /api/hf-cache/clear</code>: Clear cache</li>
</ul>
<h3>Model Configuration</h3>
<ul>
<li><code>GET /api/captioner-config/{name}</code>: Get captioner configuration</li>
<li><code>PUT /api/captioner-config/{name}</code>: Update captioner configuration</li>
</ul>
<h3>Ollama Integration</h3>
<ul>
<li><code>GET /api/ollama/status</code>: Get Ollama service status</li>
<li><code>GET /api/ollama/models</code>: List Ollama models</li>
<li><code>POST /api/ollama/models/pull</code>: Pull Ollama model</li>
</ul>
<p>All endpoints require admin authentication and return appropriate error<br>responses for unauthorized access.</p>
</div>
    </div>
  </main>
  <footer class="docs-footer"><p>&copy; 2024 Reynard Documentation Test. Built with ❤️ using SolidJS.</p></footer>
</body>
</html>