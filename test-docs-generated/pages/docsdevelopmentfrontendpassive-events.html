<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Passive Event Listeners - Reynard Documentation Test</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../highlight.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <nav class="docs-nav">
    <div class="nav-brand"><a href="../index.html">Reynard Documentation Test</a></div>
    <div class="nav-links"><a href="../index.html">Home</a><a href="../api.html">API Reference</a></div>
  </nav>
  <main class="docs-main">
    <div class="docs-content">
      <h1>Passive Event Listeners</h1>
      <div class="markdown-content"><h1>Passive Event Listeners</h1>
<p>Passive event listeners are a crucial performance optimization feature in<br>yipyap, particularly important for smooth scrolling and touch interactions. This<br>document outlines our implementation approach and best practices.</p>
<h2>Table of Contents</h2>
<ul>
<li><a href="#passive-event-listeners">Passive Event Listeners</a><ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#implementation-guidelines">Implementation Guidelines</a></li>
<li><a href="#when-to-use-passive-listeners">When to Use Passive Listeners</a></li>
<li><a href="#performance-impact">Performance Impact</a></li>
<li><a href="#browser-support">Browser Support</a></li>
<li><a href="#implementation-examples">Implementation Examples</a><ul>
<li><a href="#gallery-scroll-handling">Gallery Scroll Handling</a></li>
<li><a href="#touch-interaction-handling">Touch Interaction Handling</a></li>
<li><a href="#crawl-streaming-events">Crawl Streaming Events</a></li>
<li><a href="#non-passive-example-when-preventdefault-is-needed">Non-Passive Example (When preventDefault is needed)</a></li>
</ul>
</li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#common-pitfalls">Common Pitfalls</a></li>
<li><a href="#related-documentation">Related Documentation</a></li>
</ul>
</li>
</ul>
<h2>Overview</h2>
<hr>
<p>Passive event listeners allow the browser to optimize event handling by<br>indicating that a listener will not call <code>preventDefault()</code>. This enables the<br>browser to immediately begin scrolling operations without waiting for JavaScript<br>execution, significantly improving scroll performance.</p>
<h2>Implementation Guidelines</h2>
<hr>
<p>When adding event listeners in yipyap, follow these principles:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Preferred - explicitly declare passive for scroll/touch events</span>
element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;touchstart&quot;</span>, handler, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> });
element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;wheel&quot;</span>, handler, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> });

<span class="hljs-comment">// Only use non-passive when preventDefault is required</span>
element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;touchstart&quot;</span>, handler, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">false</span> });</code></pre><h2>When to Use Passive Listeners</h2>
<hr>
<p>Use passive listeners for:</p>
<ul>
<li>Scroll events (<code>wheel</code>, <code>touchstart</code>, <code>touchmove</code>)</li>
<li>Touch events when not preventing default behavior</li>
<li>Performance-critical event handlers</li>
<li>Analytics and tracking code</li>
</ul>
<p>Do not use passive listeners when:</p>
<ul>
<li>You need to call <code>preventDefault()</code></li>
<li>Implementing custom scroll behavior</li>
<li>Building drag-and-drop interfaces</li>
<li>Handling gesture interactions</li>
</ul>
<h2>Performance Impact</h2>
<hr>
<p>Passive event listeners can improve scroll performance by:</p>
<ul>
<li>Reducing main thread blocking</li>
<li>Enabling immediate scroll initiation</li>
<li>Decreasing input latency</li>
<li>Improving frames per second during scroll</li>
</ul>
<h2>Browser Support</h2>
<hr>
<p>Yipyap supports passive event listeners across all modern browsers:</p>
<ul>
<li>Chrome/Edge: 51+</li>
<li>Firefox: 49+</li>
<li>Safari: 10+</li>
<li>iOS Safari: 10+</li>
<li>Android Browser: 51+</li>
</ul>
<h2>Implementation Examples</h2>
<hr>
<h3>Gallery Scroll Handling</h3>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Gallery scroll handling</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">useGalleryScroll</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-title function_">onMount</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">handler</span> = (<span class="hljs-params"><span class="hljs-attr">e</span>: <span class="hljs-title class_">WheelEvent</span></span>) =&gt; {
      <span class="hljs-comment">// Scroll handling logic</span>
    };

    <span class="hljs-comment">// Use passive listener for better performance</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;wheel&quot;</span>, handler, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> });

    <span class="hljs-title function_">onCleanup</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&quot;wheel&quot;</span>, handler);
    });
  });
};</code></pre><h3>Touch Interaction Handling</h3>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Touch interaction handling</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">useTouchInteraction</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-title function_">onMount</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">touchHandler</span> = (<span class="hljs-params"><span class="hljs-attr">e</span>: <span class="hljs-title class_">TouchEvent</span></span>) =&gt; {
      <span class="hljs-comment">// Touch handling logic that doesn&#x27;t prevent default</span>
    };

    element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;touchstart&quot;</span>, touchHandler, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> });
    element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;touchmove&quot;</span>, touchHandler, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> });

    <span class="hljs-title function_">onCleanup</span>(<span class="hljs-function">() =&gt;</span> {
      element.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&quot;touchstart&quot;</span>, touchHandler);
      element.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&quot;touchmove&quot;</span>, touchHandler);
    });
  });
};</code></pre><h3>Crawl Streaming Events</h3>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// From useCrawl.ts - SSE event listeners with passive options</span>
es.<span class="hljs-title function_">addEventListener</span>(
  <span class="hljs-string">&quot;submitted&quot;</span>,
  <span class="hljs-function">(<span class="hljs-params">ev</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      handlers.<span class="hljs-property">onSubmitted</span>?.(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>((ev <span class="hljs-keyword">as</span> <span class="hljs-title class_">MessageEvent</span>).<span class="hljs-property">data</span>));
    } <span class="hljs-keyword">catch</span> {}
  },
  { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> } <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>,
);
es.<span class="hljs-title function_">addEventListener</span>(
  <span class="hljs-string">&quot;status&quot;</span>,
  <span class="hljs-function">(<span class="hljs-params">ev</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      handlers.<span class="hljs-property">onStatus</span>?.(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>((ev <span class="hljs-keyword">as</span> <span class="hljs-title class_">MessageEvent</span>).<span class="hljs-property">data</span>));
    } <span class="hljs-keyword">catch</span> {}
  },
  { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> } <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>,
);
es.<span class="hljs-title function_">addEventListener</span>(
  <span class="hljs-string">&quot;done&quot;</span>,
  <span class="hljs-function">(<span class="hljs-params">ev</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      handlers.<span class="hljs-property">onDone</span>?.(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>((ev <span class="hljs-keyword">as</span> <span class="hljs-title class_">MessageEvent</span>).<span class="hljs-property">data</span>));
    } <span class="hljs-keyword">catch</span> {}
    <span class="hljs-title function_">stop</span>();
  },
  { <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span> } <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>,
);</code></pre><h3>Non-Passive Example (When preventDefault is needed)</h3>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// From useGalleryScroll.tsx - wheel navigation that prevents default</span>
wheelHandler = <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">e</span>: <span class="hljs-title class_">WheelEvent</span></span>) =&gt;</span> {
  e.<span class="hljs-title function_">preventDefault</span>();
  <span class="hljs-comment">// ... image navigation logic ...</span>
};

<span class="hljs-comment">// Use passive listener for performance where possible; here we require preventDefault</span>
galleryElement.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;wheel&quot;</span>, wheelHandler, { <span class="hljs-attr">passive</span>: <span class="hljs-literal">false</span> });</code></pre><h2>Best Practices</h2>
<hr>
<ol>
<li>Always explicitly declare the <code>passive</code> option rather than relying on<br>defaults</li>
<li>Use TypeScript&#39;s <code>EventListenerOptions</code> type for proper type checking</li>
<li>Consider performance implications when setting <code>passive: false</code></li>
<li>Test scrolling performance with and without passive listeners</li>
<li>Monitor console for warnings about preventDefault calls in passive listeners</li>
<li>Clean up event listeners in <code>onCleanup</code> to prevent memory leaks</li>
<li>Store handler references for proper removal</li>
</ol>
<h2>Common Pitfalls</h2>
<hr>
<ul>
<li>Attempting to call <code>preventDefault()</code> in a passive listener (will be ignored)</li>
<li>Forgetting to remove event listeners during cleanup</li>
<li>Using non-passive listeners unnecessarily</li>
<li>Not testing on touch devices</li>
<li>Storing event listeners without proper cleanup mechanisms</li>
</ul>
<h2>Related Documentation</h2>
<hr>
<ul>
<li><a href="performance.md">Performance Documentation</a></li>
<li><a href="event-handling.md">Event Handling Guide</a></li>
<li><a href="touch-interactions.md">Touch Interaction Guide</a></li>
<li><a href="composables.md">Composables Documentation</a></li>
</ul>
</div>
    </div>
  </main>
  <footer class="docs-footer"><p>&copy; 2024 Reynard Documentation Test. Built with ❤️ using SolidJS.</p></footer>
</body>
</html>