<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modular Rendering Engine - Reynard Documentation Test</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../highlight.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <nav class="docs-nav">
    <div class="nav-brand"><a href="../index.html">Reynard Documentation Test</a></div>
    <div class="nav-links"><a href="../index.html">Home</a><a href="../api.html">API Reference</a></div>
  </nav>
  <main class="docs-main">
    <div class="docs-content">
      <h1>Modular Rendering Engine</h1>
      <div class="markdown-content"><h1>Modular Rendering Engine</h1>
<p>This directory contains the modular rendering engine for the FPS Point Cloud Visualizer project. The engine provides a shared foundation for both traditional and FPS visualizers, with consistent rendering contracts and reusable components.</p>
<h2>Architecture Overview</h2>
<p>The modular rendering engine consists of several key components:</p>
<h3>Core Components</h3>
<ul>
<li><strong><code>BasePointCloudRenderer</code></strong>: The main rendering component that provides a shared foundation for all point cloud visualizers</li>
<li><strong><code>EmbeddingRenderingInterface</code></strong>: Defines consistent rendering contracts and data structures</li>
<li><strong><code>PointCloudGeometryManager</code></strong>: Handles geometry creation, optimization, and management</li>
<li><strong><code>PointCloudMaterialManager</code></strong>: Manages materials, textures, and visual effects</li>
</ul>
<h3>Key Features</h3>
<ul>
<li><strong>Shared Infrastructure</strong>: Common Three.js rendering logic extracted from existing components</li>
<li><strong>Consistent Contracts</strong>: Well-defined interfaces for embedding data and rendering configuration</li>
<li><strong>Performance Optimization</strong>: Geometry and material caching, LOD support, and memory management</li>
<li><strong>Modular Design</strong>: Easy to extend and customize for different visualizer types</li>
</ul>
<h2>Usage</h2>
<h3>Basic Usage</h3>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BasePointCloudRenderer</span>, <span class="hljs-variable constant_">DEFAULT_RENDERING_CONFIG</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;~/components/rendering&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">EmbeddingPoint</span>, <span class="hljs-title class_">RenderingInterface</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;~/components/rendering&#x27;</span>;

<span class="hljs-comment">// Define your embedding points</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">points</span>: <span class="hljs-title class_">EmbeddingPoint</span>[] = [
  {
    <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;1&#x27;</span>,
    <span class="hljs-attr">position</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
    <span class="hljs-attr">color</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>],
    <span class="hljs-attr">size</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">metadata</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;image&#x27;</span> },
  },
  <span class="hljs-comment">// ... more points</span>
];

<span class="hljs-comment">// Create a rendering interface (custom implementation)</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">renderingInterface</span>: <span class="hljs-title class_">RenderingInterface</span> = {
  <span class="hljs-attr">initialize</span>: <span class="hljs-title function_">async</span> () =&gt; { <span class="hljs-comment">/* implementation */</span> },
  <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">points, config</span>) =&gt;</span> { <span class="hljs-comment">/* implementation */</span> },
  <span class="hljs-comment">// ... other interface methods</span>
};

<span class="hljs-comment">// Use the base renderer</span>
<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">BasePointCloudRenderer</span>
  <span class="hljs-attr">points</span>=<span class="hljs-string">{points}</span>
  <span class="hljs-attr">config</span>=<span class="hljs-string">{DEFAULT_RENDERING_CONFIG}</span>
  <span class="hljs-attr">interface</span>=<span class="hljs-string">{renderingInterface}</span>
  <span class="hljs-attr">width</span>=<span class="hljs-string">{800}</span>
  <span class="hljs-attr">height</span>=<span class="hljs-string">{600}</span>
  <span class="hljs-attr">backgroundColor</span>=<span class="hljs-string">&quot;#1a1a1a&quot;</span>
  <span class="hljs-attr">onPointClick</span>=<span class="hljs-string">{(point,</span> <span class="hljs-attr">event</span>) =&gt;</span> console.log(&#x27;Clicked:&#x27;, point)}
  onPointHover={(point, event) =&gt; console.log(&#x27;Hovered:&#x27;, point)}
/&gt;</span></code></pre><h3>Custom Configuration</h3>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">DEFAULT_RENDERING_CONFIG</span>, <span class="hljs-variable constant_">QUALITY_PRESETS</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;~/components/rendering&#x27;</span>;

<span class="hljs-comment">// Use quality presets</span>
<span class="hljs-keyword">const</span> highQualityConfig = {
  ...<span class="hljs-variable constant_">DEFAULT_RENDERING_CONFIG</span>,
  ...<span class="hljs-variable constant_">QUALITY_PRESETS</span>.<span class="hljs-property">high</span>,
};

<span class="hljs-comment">// Custom configuration</span>
<span class="hljs-keyword">const</span> customConfig = {
  ...<span class="hljs-variable constant_">DEFAULT_RENDERING_CONFIG</span>,
  <span class="hljs-attr">pointSize</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">colorMapping</span>: <span class="hljs-string">&#x27;cluster&#x27;</span>,
  <span class="hljs-attr">sizeMapping</span>: <span class="hljs-string">&#x27;importance&#x27;</span>,
  <span class="hljs-attr">enableThumbnails</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableTextSprites</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enableAnimations</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">animationDuration</span>: <span class="hljs-number">1500</span>,
};</code></pre><h3>Geometry and Material Management</h3>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PointCloudGeometryManager</span>, <span class="hljs-title class_">PointCloudMaterialManager</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;~/components/rendering&#x27;</span>;

<span class="hljs-comment">// Initialize managers (requires Three.js modules)</span>
<span class="hljs-keyword">const</span> threeJS = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;three&#x27;</span>);
<span class="hljs-keyword">const</span> geometryManager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PointCloudGeometryManager</span>(threeJS);
<span class="hljs-keyword">const</span> materialManager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PointCloudMaterialManager</span>(threeJS);

<span class="hljs-comment">// Create geometry</span>
<span class="hljs-keyword">const</span> geometry = geometryManager.<span class="hljs-title function_">createPointGeometry</span>(points, config);

<span class="hljs-comment">// Create material</span>
<span class="hljs-keyword">const</span> material = materialManager.<span class="hljs-title function_">createPointMaterial</span>(config);

<span class="hljs-comment">// Optimize for performance</span>
geometryManager.<span class="hljs-title function_">optimizeForPerformance</span>();
materialManager.<span class="hljs-title function_">optimizeForPerformance</span>();</code></pre><h2>Data Structures</h2>
<h3>EmbeddingPoint</h3>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmbeddingPoint</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">position</span>: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>];
  <span class="hljs-attr">color</span>?: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>];
  <span class="hljs-attr">size</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">metadata</span>?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;;
  <span class="hljs-attr">importance</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">confidence</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">clusterId</span>?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">similarity</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">imageUrl</span>?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">imageThumbnail</span>?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">textContent</span>?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">contentType</span>?: <span class="hljs-string">&#x27;image&#x27;</span> | <span class="hljs-string">&#x27;text&#x27;</span> | <span class="hljs-string">&#x27;mixed&#x27;</span>;
  <span class="hljs-attr">thumbnailDataUrl</span>?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">originalEmbedding</span>?: <span class="hljs-built_in">number</span>[];
  <span class="hljs-attr">reducedEmbedding</span>?: <span class="hljs-built_in">number</span>[];
}</code></pre><h3>EmbeddingRenderingConfig</h3>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">EmbeddingRenderingConfig</span> {
  <span class="hljs-comment">// Point cloud settings</span>
  <span class="hljs-attr">pointSize</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">colorMapping</span>: <span class="hljs-string">&#x27;similarity&#x27;</span> | <span class="hljs-string">&#x27;cluster&#x27;</span> | <span class="hljs-string">&#x27;importance&#x27;</span> | <span class="hljs-string">&#x27;confidence&#x27;</span> | <span class="hljs-string">&#x27;custom&#x27;</span>;
  <span class="hljs-attr">sizeMapping</span>: <span class="hljs-string">&#x27;importance&#x27;</span> | <span class="hljs-string">&#x27;confidence&#x27;</span> | <span class="hljs-string">&#x27;uniform&#x27;</span>;
  
  <span class="hljs-comment">// Performance settings</span>
  <span class="hljs-attr">enableInstancing</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">enableLOD</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">enableCulling</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">lodDistance</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">lodLevels</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">maxPoints</span>: <span class="hljs-built_in">number</span>;
  
  <span class="hljs-comment">// Visual effects</span>
  <span class="hljs-attr">enableThumbnails</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">enableTextSprites</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">thumbnailSize</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">textSpriteSize</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">enableHighlighting</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">highlightColor</span>: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>];
  <span class="hljs-attr">highlightSize</span>: <span class="hljs-built_in">number</span>;
  
  <span class="hljs-comment">// Animation settings</span>
  <span class="hljs-attr">enableAnimations</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">animationDuration</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">animationEasing</span>: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-comment">// Search integration</span>
  <span class="hljs-attr">enableSearchIntegration</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">// ... additional search-related properties</span>
}</code></pre><h2>Performance Features</h2>
<h3>Quality Presets</h3>
<p>The engine provides three quality presets for different performance levels:</p>
<ul>
<li><strong>Low</strong>: Optimized for performance, reduced visual quality</li>
<li><strong>Medium</strong>: Balanced performance and visual quality</li>
<li><strong>High</strong>: Maximum visual quality, higher performance requirements</li>
</ul>
<h3>Memory Management</h3>
<ul>
<li>Automatic geometry and material caching</li>
<li>Memory usage monitoring and cleanup</li>
<li>Efficient disposal of unused resources</li>
<li>Performance optimization based on hardware capabilities</li>
</ul>
<h3>Optimization Features</h3>
<ul>
<li>Level-of-Detail (LOD) system for large datasets</li>
<li>Frustum culling for off-screen points</li>
<li>Occlusion culling for hidden points</li>
<li>Instanced rendering for better performance</li>
</ul>
<h2>Integration with Existing Components</h2>
<p>The modular rendering engine is designed to work seamlessly with existing components:</p>
<ul>
<li><strong>EmbeddingPointCloud</strong>: Can be refactored to use the base renderer</li>
<li><strong>ThreeJSVisualization</strong>: Provides the underlying Three.js infrastructure</li>
<li><strong>RAG Integration</strong>: Supports search result visualization</li>
<li><strong>Performance Monitoring</strong>: Integrates with existing performance tools</li>
</ul>
<h2>Future Extensions</h2>
<p>The modular architecture makes it easy to add new features:</p>
<ul>
<li><strong>FPS Visualizer</strong>: Can extend the base renderer with FPS-specific controls</li>
<li><strong>Custom Shaders</strong>: Material manager supports custom shader materials</li>
<li><strong>Advanced Effects</strong>: Post-processing and visual effects can be added</li>
<li><strong>Multiplayer Support</strong>: Shared state management for collaborative viewing</li>
</ul>
<h2>Testing</h2>
<p>The rendering engine includes comprehensive tests:</p>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Run tests for the rendering engine</span>
npm <span class="hljs-built_in">test</span> -- --run src/components/rendering/

<span class="hljs-comment"># Run specific test file</span>
npm <span class="hljs-built_in">test</span> -- --run src/components/rendering/BasePointCloudRenderer.test.tsx</code></pre><h2>Contributing</h2>
<p>When extending the rendering engine:</p>
<ol>
<li>Follow the established interface contracts</li>
<li>Add tests for new functionality</li>
<li>Update documentation for new features</li>
<li>Ensure backward compatibility</li>
<li>Consider performance implications</li>
</ol>
<h2>Dependencies</h2>
<ul>
<li><strong>Three.js</strong>: Core 3D rendering library</li>
<li><strong>SolidJS</strong>: Component framework</li>
<li><strong>Vitest</strong>: Testing framework</li>
<li><strong>TypeScript</strong>: Type safety and development experience</li>
</ul>
</div>
    </div>
  </main>
  <footer class="docs-footer"><p>&copy; 2024 Reynard Documentation Test. Built with ❤️ using SolidJS.</p></footer>
</body>
</html>