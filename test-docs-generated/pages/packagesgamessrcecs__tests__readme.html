<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reynard ECS Test Suite - Reynard Documentation Test</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../highlight.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <nav class="docs-nav">
    <div class="nav-brand"><a href="../index.html">Reynard Documentation Test</a></div>
    <div class="nav-links"><a href="../index.html">Home</a><a href="../api.html">API Reference</a></div>
  </nav>
  <main class="docs-main">
    <div class="docs-content">
      <h1>Reynard ECS Test Suite</h1>
      <div class="markdown-content"><h1>Reynard ECS Test Suite</h1>
<p>This directory contains comprehensive tests for the Reynard ECS (Entity-Component-System) implementation. The tests are organized by system component and cover all aspects of the ECS architecture.</p>
<h2>Test Structure</h2>
<h3>Core Tests</h3>
<ul>
<li><strong><code>core-types.test.ts</code></strong> - Tests for fundamental ECS types (Entity, Component, Resource)</li>
<li><strong><code>world.test.ts</code></strong> - Tests for World system (entity management, component operations, resources)</li>
<li><strong><code>query.test.ts</code></strong> - Tests for Query system (component filtering, iteration, performance)</li>
<li><strong><code>system.test.ts</code></strong> - Tests for System scheduling, execution, and dependency management</li>
<li><strong><code>archetype.test.ts</code></strong> - Tests for Archetype system (entity storage optimization)</li>
<li><strong><code>change-detection.test.ts</code></strong> - Tests for Change Detection system (component modification tracking)</li>
</ul>
<h3>Integration Tests</h3>
<ul>
<li><strong><code>integration.test.ts</code></strong> - End-to-end tests with complete game scenarios</li>
<li><strong><code>index.test.ts</code></strong> - Test suite index and utilities</li>
</ul>
<h2>Test Categories</h2>
<h3>1. Core Types (<code>core-types.test.ts</code>)</h3>
<p>Tests the fundamental building blocks of the ECS:</p>
<ul>
<li><strong>Entity System</strong>: Entity creation, comparison, serialization</li>
<li><strong>Component Interface</strong>: Component implementation and type safety</li>
<li><strong>Resource Interface</strong>: Resource implementation and type safety</li>
<li><strong>Type Safety</strong>: Prevention of type mixing and immutability</li>
</ul>
<h3>2. World System (<code>world.test.ts</code>)</h3>
<p>Tests the central ECS container:</p>
<ul>
<li><strong>Entity Management</strong>: Spawning, despawning, lifecycle</li>
<li><strong>Component Management</strong>: Adding, removing, updating components</li>
<li><strong>Resource Management</strong>: Global state management</li>
<li><strong>Query System</strong>: Basic query functionality</li>
<li><strong>Commands System</strong>: Deferred operations</li>
<li><strong>Error Handling</strong>: Graceful error handling</li>
</ul>
<h3>3. Query System (<code>query.test.ts</code>)</h3>
<p>Tests the component filtering and iteration system:</p>
<ul>
<li><strong>Basic Queries</strong>: Single and multiple component queries</li>
<li><strong>Query Filters</strong>: <code>with</code>, <code>without</code>, <code>added</code>, <code>changed</code> filters</li>
<li><strong>Change Detection Queries</strong>: Change-based filtering</li>
<li><strong>Query Iteration</strong>: Efficient iteration over results</li>
<li><strong>Performance</strong>: Large-scale query performance</li>
<li><strong>Query State Management</strong>: State consistency across iterations</li>
</ul>
<h3>4. System System (<code>system.test.ts</code>)</h3>
<p>Tests the system scheduling and execution:</p>
<ul>
<li><strong>Basic System Execution</strong>: Simple system execution</li>
<li><strong>System Dependencies</strong>: Dependency-based execution order</li>
<li><strong>System Conditions</strong>: Conditional system execution</li>
<li><strong>System Sets</strong>: Grouped system execution</li>
<li><strong>Performance</strong>: Many systems and entities</li>
<li><strong>Error Handling</strong>: System error handling</li>
</ul>
<h3>5. Archetype System (<code>archetype.test.ts</code>)</h3>
<p>Tests the entity storage optimization:</p>
<ul>
<li><strong>Archetype Creation</strong>: Different component combinations</li>
<li><strong>Component Layout</strong>: Component type tracking and ordering</li>
<li><strong>Entity Management</strong>: Entity tracking in archetypes</li>
<li><strong>Performance</strong>: Large-scale archetype operations</li>
<li><strong>Storage</strong>: Component data integrity</li>
<li><strong>Edge Cases</strong>: Empty archetypes, rapid changes</li>
</ul>
<h3>6. Change Detection (<code>change-detection.test.ts</code>)</h3>
<p>Tests the component modification tracking:</p>
<ul>
<li><strong>Tick System</strong>: Time-based change tracking</li>
<li><strong>Component Change Tracking</strong>: Add, modify, remove tracking</li>
<li><strong>Change-Based Queries</strong>: Change detection in queries</li>
<li><strong>Performance</strong>: Large-scale change tracking</li>
<li><strong>Edge Cases</strong>: Rapid changes, tick overflow</li>
<li><strong>Integration</strong>: Change detection with other systems</li>
</ul>
<h3>7. Integration Tests (<code>integration.test.ts</code>)</h3>
<p>Tests complete ECS scenarios:</p>
<ul>
<li><strong>Complete Game Loop</strong>: Full game loop with all systems</li>
<li><strong>System Dependencies</strong>: Complex dependency chains</li>
<li><strong>Resource Management</strong>: Resource sharing between systems</li>
<li><strong>Performance</strong>: Large-scale scenarios</li>
<li><strong>Error Handling</strong>: System error recovery</li>
<li><strong>Real-World Scenarios</strong>: Complete shooter game simulation</li>
</ul>
<h2>Running Tests</h2>
<h3>Prerequisites</h3>
<ul>
<li>Node.js 18+</li>
<li>npm or yarn</li>
<li>Vitest test runner</li>
</ul>
<h3>Installation</h3>
<pre><code class="hljs language-bash">npm install</code></pre><h3>Running All Tests</h3>
<pre><code class="hljs language-bash">npm <span class="hljs-built_in">test</span></code></pre><h3>Running Specific Test Files</h3>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Run core types tests</span>
npm <span class="hljs-built_in">test</span> core-types.test.ts

<span class="hljs-comment"># Run world system tests</span>
npm <span class="hljs-built_in">test</span> world.test.ts

<span class="hljs-comment"># Run query system tests</span>
npm <span class="hljs-built_in">test</span> query.test.ts

<span class="hljs-comment"># Run system tests</span>
npm <span class="hljs-built_in">test</span> system.test.ts

<span class="hljs-comment"># Run archetype tests</span>
npm <span class="hljs-built_in">test</span> archetype.test.ts

<span class="hljs-comment"># Run change detection tests</span>
npm <span class="hljs-built_in">test</span> change-detection.test.ts

<span class="hljs-comment"># Run integration tests</span>
npm <span class="hljs-built_in">test</span> integration.test.ts</code></pre><h3>Running Tests with Coverage</h3>
<pre><code class="hljs language-bash">npm run <span class="hljs-built_in">test</span>:coverage</code></pre><h2>Test Utilities</h2>
<p>The test suite includes utilities for common testing patterns:</p>
<ul>
<li><strong><code>TestUtils.createTestWorld()</code></strong> - Creates a test world with common types</li>
<li><strong><code>TestUtils.createTestEntities()</code></strong> - Creates test entities with various components</li>
<li><strong><code>TestUtils.measurePerformance()</code></strong> - Measures function execution time</li>
<li><strong><code>TestUtils.assertPerformance()</code></strong> - Asserts performance within limits</li>
</ul>
<h2>Performance Benchmarks</h2>
<p>The tests include performance benchmarks to ensure the ECS system can handle:</p>
<ul>
<li><strong>1000+ entities</strong> with multiple components</li>
<li><strong>100+ systems</strong> with complex dependencies</li>
<li><strong>10,000+ queries</strong> per second</li>
<li><strong>Rapid component changes</strong> without performance degradation</li>
</ul>
<h2>Test Data</h2>
<h3>Common Test Components</h3>
<ul>
<li><strong><code>Position</code></strong> - 2D position (x, y)</li>
<li><strong><code>Velocity</code></strong> - 2D velocity (x, y)</li>
<li><strong><code>Health</code></strong> - Health points (current, maximum)</li>
<li><strong><code>Player</code></strong> - Player marker component</li>
<li><strong><code>Enemy</code></strong> - Enemy marker component</li>
<li><strong><code>Bullet</code></strong> - Bullet marker component</li>
<li><strong><code>Renderable</code></strong> - Rendering information</li>
</ul>
<h3>Common Test Resources</h3>
<ul>
<li><strong><code>GameTime</code></strong> - Game timing information</li>
<li><strong><code>GameState</code></strong> - Global game state</li>
<li><strong><code>InputState</code></strong> - Input handling state</li>
</ul>
<h2>Best Practices</h2>
<h3>Writing Tests</h3>
<ol>
<li><strong>Use descriptive test names</strong> that explain what is being tested</li>
<li><strong>Test both success and failure cases</strong> for robust error handling</li>
<li><strong>Include performance tests</strong> for critical paths</li>
<li><strong>Use realistic test data</strong> that mirrors actual usage</li>
<li><strong>Test edge cases</strong> like empty collections, null values, etc.</li>
</ol>
<h3>Test Organization</h3>
<ol>
<li><strong>Group related tests</strong> using <code>describe</code> blocks</li>
<li><strong>Use <code>beforeEach</code></strong> for common setup</li>
<li><strong>Keep tests focused</strong> on a single behavior</li>
<li><strong>Use meaningful assertions</strong> with clear error messages</li>
</ol>
<h3>Performance Testing</h3>
<ol>
<li><strong>Set reasonable performance limits</strong> based on requirements</li>
<li><strong>Test with realistic data sizes</strong> (1000+ entities)</li>
<li><strong>Measure actual performance</strong> not just functionality</li>
<li><strong>Include memory usage tests</strong> where relevant</li>
</ol>
<h2>Contributing</h2>
<p>When adding new tests:</p>
<ol>
<li><strong>Follow the existing test structure</strong> and naming conventions</li>
<li><strong>Add tests for new features</strong> in the appropriate test file</li>
<li><strong>Update this README</strong> if adding new test categories</li>
<li><strong>Ensure all tests pass</strong> before submitting changes</li>
<li><strong>Add performance tests</strong> for performance-critical features</li>
</ol>
<h2>Troubleshooting</h2>
<h3>Common Issues</h3>
<ol>
<li><strong>Tests failing due to type errors</strong> - Check that all imports are correct</li>
<li><strong>Performance tests failing</strong> - Adjust performance limits based on system capabilities</li>
<li><strong>Memory leaks in tests</strong> - Ensure proper cleanup in <code>afterEach</code> blocks</li>
<li><strong>Flaky tests</strong> - Add proper synchronization and avoid race conditions</li>
</ol>
<h3>Debug Tips</h3>
<ol>
<li><strong>Use <code>console.log</code></strong> for debugging test execution</li>
<li><strong>Check test coverage</strong> to ensure all code paths are tested</li>
<li><strong>Run tests individually</strong> to isolate issues</li>
<li><strong>Use test utilities</strong> for common testing patterns</li>
</ol>
</div>
    </div>
  </main>
  <footer class="docs-footer"><p>&copy; 2024 Reynard Documentation Test. Built with ❤️ using SolidJS.</p></footer>
</body>
</html>