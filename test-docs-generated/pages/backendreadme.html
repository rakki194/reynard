<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reynard FastAPI Backend - Reynard Documentation Test</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../highlight.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <nav class="docs-nav">
    <div class="nav-brand"><a href="../index.html">Reynard Documentation Test</a></div>
    <div class="nav-links"><a href="../index.html">Home</a><a href="../api.html">API Reference</a></div>
  </nav>
  <main class="docs-main">
    <div class="docs-content">
      <h1>Reynard FastAPI Backend</h1>
      <div class="markdown-content"><h1>Reynard FastAPI Backend</h1>
<p>A secure, JWT-based authentication backend for the Reynard project, built with FastAPI and Python.</p>
<h2>Features</h2>
<ul>
<li>üîê <strong>JWT Authentication</strong>: Secure token-based authentication with access and refresh tokens</li>
<li>üõ°Ô∏è <strong>Password Security</strong>: PBKDF2 with HMAC-SHA256 password hashing (no bcrypt/passlib)</li>
<li>üîí <strong>Security Headers</strong>: Comprehensive security middleware and headers</li>
<li>üìö <strong>Auto Documentation</strong>: Interactive API documentation with Swagger UI</li>
<li>üöÄ <strong>High Performance</strong>: Built on FastAPI for maximum performance</li>
<li>üß™ <strong>Tested</strong>: Comprehensive test suite for all endpoints</li>
</ul>
<h2>Quick Start</h2>
<h3>Prerequisites</h3>
<ul>
<li>Python 3.8+</li>
<li>pip (Python package manager)</li>
</ul>
<h3>Installation</h3>
<ol>
<li><p><strong>Clone the repository</strong> (if not already done):</p>
<pre><code class="hljs language-bash">git <span class="hljs-built_in">clone</span> &lt;repository-url&gt;
<span class="hljs-built_in">cd</span> reynard/backend</code></pre></li>
<li><p><strong>Create a virtual environment</strong>:</p>
<pre><code class="hljs language-bash">python -m venv venv
<span class="hljs-built_in">source</span> venv/bin/activate  <span class="hljs-comment"># On Windows: venv\Scripts\activate</span></code></pre></li>
<li><p><strong>Install dependencies</strong>:</p>
<pre><code class="hljs language-bash">pip install -r requirements.txt</code></pre></li>
<li><p><strong>Set up environment variables</strong>:</p>
<pre><code class="hljs language-bash"><span class="hljs-built_in">cp</span> .env.example .<span class="hljs-built_in">env</span>
<span class="hljs-comment"># Edit .env with your configuration</span></code></pre></li>
<li><p><strong>Run the development server</strong>:</p>
<pre><code class="hljs language-bash">python main.py</code></pre></li>
</ol>
<p>The API will be available at <code>http://localhost:8000</code></p>
<h2>API Documentation</h2>
<p>Once the server is running, you can access:</p>
<ul>
<li><strong>Swagger UI</strong>: <a href="http://localhost:8000/api/docs">http://localhost:8000/api/docs</a></li>
<li><strong>ReDoc</strong>: <a href="http://localhost:8000/api/redoc">http://localhost:8000/api/redoc</a></li>
<li><strong>OpenAPI JSON</strong>: <a href="http://localhost:8000/openapi.json">http://localhost:8000/openapi.json</a></li>
</ul>
<h2>API Endpoints</h2>
<h3>Authentication</h3>
<ul>
<li><code>POST /api/auth/register</code> - Register a new user</li>
<li><code>POST /api/auth/login</code> - Login and get tokens</li>
<li><code>POST /api/auth/refresh</code> - Refresh access token</li>
<li><code>POST /api/auth/logout</code> - Logout and invalidate tokens</li>
<li><code>GET /api/auth/me</code> - Get current user information</li>
</ul>
<h3>Protected Routes</h3>
<ul>
<li><code>GET /api/protected</code> - Example protected route</li>
<li><code>GET /api/health</code> - Health check endpoint</li>
</ul>
<h2>Security Features</h2>
<h3>Password Hashing</h3>
<p>The backend uses PBKDF2 with HMAC-SHA256 for password hashing, providing:</p>
<ul>
<li><strong>Salt</strong>: Each password gets a unique 32-byte salt</li>
<li><strong>Iterations</strong>: 100,000 iterations for key derivation</li>
<li><strong>Constant-time comparison</strong>: Prevents timing attacks</li>
<li><strong>No external dependencies</strong>: Uses only Python standard library</li>
</ul>
<h3>JWT Tokens</h3>
<ul>
<li><strong>Access Tokens</strong>: Short-lived (30 minutes) for API access</li>
<li><strong>Refresh Tokens</strong>: Long-lived (7 days) for token renewal</li>
<li><strong>Secure Signing</strong>: HMAC-SHA256 with configurable secret key</li>
<li><strong>Token Validation</strong>: Comprehensive token verification</li>
</ul>
<h3>Security Headers</h3>
<ul>
<li><strong>CORS</strong>: Configurable cross-origin resource sharing</li>
<li><strong>Trusted Hosts</strong>: Protection against host header attacks</li>
<li><strong>Security Headers</strong>: X-Frame-Options, X-Content-Type-Options, etc.</li>
</ul>
<h2>Configuration</h2>
<h3>Environment Variables</h3>
<p>Create a <code>.env</code> file in the backend directory:</p>
<pre><code class="hljs"><span class="hljs-comment"># JWT Secret Key (generate a secure random key)</span>
<span class="hljs-attr">SECRET_KEY</span>=your-secret-key-here

<span class="hljs-comment"># Token expiration times</span>
<span class="hljs-attr">ACCESS_TOKEN_EXPIRE_MINUTES</span>=<span class="hljs-number">30</span>
<span class="hljs-attr">REFRESH_TOKEN_EXPIRE_DAYS</span>=<span class="hljs-number">7</span>

<span class="hljs-comment"># CORS settings</span>
<span class="hljs-attr">ALLOWED_ORIGINS</span>=http://localhost:<span class="hljs-number">3000</span>,http://localhost:<span class="hljs-number">5173</span>

<span class="hljs-comment"># Development settings</span>
<span class="hljs-attr">DEBUG</span>=<span class="hljs-literal">True</span>
<span class="hljs-attr">LOG_LEVEL</span>=info</code></pre><h3>Generating a Secure Secret Key</h3>
<pre><code class="hljs language-bash">python -c <span class="hljs-string">&quot;import secrets; print(secrets.token_urlsafe(32))&quot;</span></code></pre><h2>Testing</h2>
<h3>Manual Testing</h3>
<p>Use the provided test script:</p>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Start the backend server first</span>
python main.py

<span class="hljs-comment"># In another terminal, run the tests</span>
python scripts/test-backend.py</code></pre><h3>API Testing with curl</h3>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Register a user</span>
curl -X POST <span class="hljs-string">&quot;http://localhost:8000/api/auth/register&quot;</span> \
     -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \
     -d <span class="hljs-string">&#x27;{&quot;username&quot;: &quot;testuser&quot;, &quot;email&quot;: &quot;test@example.com&quot;, &quot;password&quot;: &quot;testpassword123&quot;}&#x27;</span>

<span class="hljs-comment"># Login</span>
curl -X POST <span class="hljs-string">&quot;http://localhost:8000/api/auth/login&quot;</span> \
     -H <span class="hljs-string">&quot;Content-Type: application/json&quot;</span> \
     -d <span class="hljs-string">&#x27;{&quot;username&quot;: &quot;testuser&quot;, &quot;password&quot;: &quot;testpassword123&quot;}&#x27;</span>

<span class="hljs-comment"># Access protected route (replace TOKEN with actual token)</span>
curl -X GET <span class="hljs-string">&quot;http://localhost:8000/api/protected&quot;</span> \
     -H <span class="hljs-string">&quot;Authorization: Bearer TOKEN&quot;</span></code></pre><h2>Production Deployment</h2>
<h3>Docker</h3>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Build the Docker image</span>
docker build -t reynard-backend .

<span class="hljs-comment"># Run the container</span>
docker run -p 8000:8000 --env-file .<span class="hljs-built_in">env</span> reynard-backend</code></pre><h3>Nginx Integration</h3>
<p>The backend is designed to work with Nginx as a reverse proxy. See the <code>nginx/</code> directory for configuration examples.</p>
<h3>Security Considerations</h3>
<p>For production deployment:</p>
<ol>
<li><strong>Use HTTPS</strong>: Always use SSL/TLS in production</li>
<li><strong>Secure Secret Key</strong>: Use a strong, randomly generated secret key</li>
<li><strong>Database</strong>: Replace in-memory storage with a proper database</li>
<li><strong>Rate Limiting</strong>: Implement rate limiting for authentication endpoints</li>
<li><strong>Logging</strong>: Set up proper logging and monitoring</li>
<li><strong>Environment</strong>: Use environment-specific configurations</li>
</ol>
<h2>Development</h2>
<h3>Project Structure</h3>
<pre><code class="hljs"><span class="hljs-keyword">backend/
</span>‚îú‚îÄ‚îÄ main.py              <span class="hljs-comment"># FastAPI application</span>
‚îú‚îÄ‚îÄ requirements.txt     <span class="hljs-comment"># Python dependencies</span>
‚îú‚îÄ‚îÄ .env                 <span class="hljs-comment"># Environment variables</span>
‚îú‚îÄ‚îÄ .env.example         <span class="hljs-comment"># Environment variables template</span>
‚îú‚îÄ‚îÄ README.md           <span class="hljs-comment"># This file</span>
‚îî‚îÄ‚îÄ <span class="hljs-keyword">scripts/
</span>    ‚îî‚îÄ‚îÄ test-<span class="hljs-keyword">backend.py </span><span class="hljs-comment"># Test script</span></code></pre><h3>Adding New Endpoints</h3>
<ol>
<li>Define Pydantic models for request/response</li>
<li>Create the endpoint function</li>
<li>Add appropriate dependencies for authentication</li>
<li>Update this README with the new endpoint</li>
</ol>
<h3>Database Integration</h3>
<p>To add database support:</p>
<ol>
<li>Install a database driver (e.g., <code>sqlalchemy</code>, <code>asyncpg</code>)</li>
<li>Create database models</li>
<li>Replace in-memory storage with database operations</li>
<li>Add database migrations</li>
</ol>
<h2>Troubleshooting</h2>
<h3>Common Issues</h3>
<ol>
<li><strong>Port already in use</strong>: Change the port in <code>main.py</code> or stop the conflicting service</li>
<li><strong>Import errors</strong>: Ensure all dependencies are installed in the virtual environment</li>
<li><strong>JWT errors</strong>: Check that the SECRET_KEY is set and consistent</li>
<li><strong>CORS errors</strong>: Verify ALLOWED_ORIGINS includes your frontend URL</li>
</ol>
<h3>Logs</h3>
<p>The application logs to stdout. For production, consider using a proper logging configuration.</p>
<h2>Contributing</h2>
<ol>
<li>Follow the existing code style</li>
<li>Add tests for new features</li>
<li>Update documentation</li>
<li>Ensure all tests pass</li>
</ol>
<h2>License</h2>
<p>This project is part of the Reynard framework. See the main project for license information.</p>
</div>
    </div>
  </main>
  <footer class="docs-footer"><p>&copy; 2024 Reynard Documentation Test. Built with ‚ù§Ô∏è using SolidJS.</p></footer>
</body>
</html>