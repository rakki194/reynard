<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notification System - Reynard Documentation Test</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../highlight.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <nav class="docs-nav">
    <div class="nav-brand"><a href="../index.html">Reynard Documentation Test</a></div>
    <div class="nav-links"><a href="../index.html">Home</a><a href="../api.html">API Reference</a></div>
  </nav>
  <main class="docs-main">
    <div class="docs-content">
      <h1>Notification System</h1>
      <div class="markdown-content"><h1>Notification System</h1>
<h2>Table of Contents</h2>
<hr>
<ul>
<li><a href="#notification-system">Notification System</a><ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#components">Components</a><ul>
<li><a href="#notificationcontainer-notificationcontainertsx">NotificationContainer (<code>NotificationContainer.tsx</code>)</a></li>
<li><a href="#notification-notificationtsx">Notification (<code>Notification.tsx</code>)</a></li>
</ul>
</li>
<li><a href="#public-api">Public API</a></li>
<li><a href="#styling">Styling</a></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#advanced-updates-and-grouping">Advanced updates and grouping</a></li>
<li><a href="#streaming-examples-diffusion-llm">Streaming examples (Diffusion LLM)</a></li>
<li><a href="#nlweb-integration-notifications">NLWeb Integration Notifications</a></li>
<li><a href="#tts-and-crawl-integration-notifications">TTS and Crawl Integration Notifications</a></li>
<li><a href="#rag-ingest-and-progress-notifications">RAG Ingest and Progress Notifications</a></li>
</ul>
</li>
<li><a href="#features">Features</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#implementation-details">Implementation Details</a></li>
<li><a href="#customization">Customization</a></li>
<li><a href="#accessibility">Accessibility</a></li>
<li><a href="#testing">Testing</a></li>
</ul>
</li>
</ul>
<p>The notification system in yipyap provides a flexible and accessible way to<br>display toast notifications. It consists of two main components:</p>
<h2>Components</h2>
<hr>
<h3>NotificationContainer (<code>NotificationContainer.tsx</code>)</h3>
<p>The <code>NotificationContainer</code> serves as a global container component that manages<br>all notifications in the application. It handles the stacking and positioning of<br>notifications as they appear and disappear. The container is responsible for<br>managing the full lifecycle of notifications, including their entrance and exit<br>animations.</p>
<h3>Notification (<code>Notification.tsx</code>)</h3>
<p>The <code>Notification</code> component represents an individual notification element that<br>can be displayed to the user. It provides support for different notification<br>types including error, success, info, and warning messages. Each notification<br>includes appropriate progress indicators and icons based on its type and state.</p>
<h2>Public API</h2>
<hr>
<p>Notifications are created primarily via the app context&#39;s <code>notify</code> function,<br>which also integrates translations. The container exposes a small global API<br>used internally by the app context and that can be used for advanced flows.</p>
<ul>
<li>App context API (recommended):</li>
</ul>
<pre><code class="hljs language-ts"><span class="hljs-comment">// Signature</span>
<span class="hljs-title function_">notify</span>(
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">type</span>?: <span class="hljs-string">&quot;error&quot;</span> | <span class="hljs-string">&quot;success&quot;</span> | <span class="hljs-string">&quot;info&quot;</span> | <span class="hljs-string">&quot;warning&quot;</span>,
  <span class="hljs-attr">group</span>?: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">icon</span>?: <span class="hljs-string">&quot;spinner&quot;</span> | <span class="hljs-string">&quot;success&quot;</span> | <span class="hljs-string">&quot;error&quot;</span> | <span class="hljs-string">&quot;info&quot;</span> | <span class="hljs-string">&quot;warning&quot;</span>,
  <span class="hljs-attr">progress</span>?: <span class="hljs-built_in">number</span>
): <span class="hljs-built_in">void</span></code></pre><p>Messages pass through the translator <code>t(message)</code> automatically. If a <code>group</code> is<br>provided, existing notifications in that group are updated in-place when<br>possible. When <code>icon</code> is omitted, it is derived from <code>type</code>; supplying<br><code>&quot;spinner&quot;</code> pins the toast (no auto-dismiss) and shows a spinning icon. The<br><code>progress</code> value is clamped to [0, 100] and renders an ARIA progressbar.</p>
<ul>
<li>Container global API (advanced): The <code>NotificationContainer</code> registers a<br>global object on <code>window</code>:</li>
</ul>
<pre><code class="hljs language-ts"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">NotificationItem</span> {
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;error&quot;</span> | <span class="hljs-string">&quot;success&quot;</span> | <span class="hljs-string">&quot;info&quot;</span> | <span class="hljs-string">&quot;warning&quot;</span>;
  <span class="hljs-attr">group</span>?: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">icon</span>?: <span class="hljs-string">&quot;spinner&quot;</span> | <span class="hljs-string">&quot;success&quot;</span> | <span class="hljs-string">&quot;error&quot;</span> | <span class="hljs-string">&quot;info&quot;</span> | <span class="hljs-string">&quot;warning&quot;</span>;
  <span class="hljs-attr">progress</span>?: <span class="hljs-built_in">number</span>;
}

<span class="hljs-comment">// available on window under __notificationContainer</span>
<span class="hljs-title function_">addNotification</span>(<span class="hljs-attr">notification</span>: <span class="hljs-title class_">NotificationItem</span>): <span class="hljs-built_in">void</span>
<span class="hljs-title function_">removeNotification</span>(<span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span>
<span class="hljs-title function_">removeNotificationByGroup</span>(<span class="hljs-attr">group</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span>
<span class="hljs-title function_">getNotificationIdByGroup</span>(<span class="hljs-attr">group</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span></code></pre><p>This API is used by <code>notify(...)</code> behind the scenes to add or update<br>notifications by group, and can be used directly when you need low-level control<br>(e.g., fixed IDs or batch removal by group).</p>
<h2>Styling</h2>
<hr>
<p>The notification system uses the following styles:</p>
<ul>
<li><code>Notification.module.css</code>: Individual notification styling and variants</li>
<li><code>NotificationContainer.css</code>: Container and layout styling</li>
</ul>
<h2>Usage</h2>
<hr>
<p>Notifications can be created through the app context:</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">const</span> { notify } = <span class="hljs-title function_">useAppContext</span>();

<span class="hljs-comment">// Basic usage</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Operation completed&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>);

<span class="hljs-comment">// With custom icon and group</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Processing...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, <span class="hljs-string">&quot;upload&quot;</span>, <span class="hljs-string">&quot;spinner&quot;</span>);

<span class="hljs-comment">// With progress tracking</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Uploading...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, <span class="hljs-string">&quot;upload&quot;</span>, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">45</span>);</code></pre><h3>Advanced updates and grouping</h3>
<p>Use groups to update or replace ongoing operations. The app context attempts to<br>update an existing grouped notification rather than creating a new one.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> group = <span class="hljs-string">`upload-<span class="hljs-subst">${file.id}</span>`</span>;
<span class="hljs-comment">// Start</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">`Uploading <span class="hljs-subst">${file.name}</span>...`</span>, <span class="hljs-string">&quot;info&quot;</span>, group, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// Progress updates (call as progress arrives)</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">`Uploading <span class="hljs-subst">${file.name}</span>...`</span>, <span class="hljs-string">&quot;info&quot;</span>, group, <span class="hljs-string">&quot;spinner&quot;</span>, percent);

<span class="hljs-comment">// Complete or error</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">`<span class="hljs-subst">${file.name}</span> uploaded`</span>, <span class="hljs-string">&quot;success&quot;</span>, group);
<span class="hljs-comment">// or</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">`Upload failed: <span class="hljs-subst">${reason}</span>`</span>, <span class="hljs-string">&quot;error&quot;</span>, group);</code></pre><h3>Streaming examples (Diffusion LLM)</h3>
<p>When consuming SSE streams (e.g., diffusion text generation), create a grouped<br>notification before starting, update UI on steps, and replace with a success or<br>error on completion. For batch mode, use a shared group for the whole batch and<br>per-item subgroups:</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">const</span> group = <span class="hljs-string">`diffusion-generate-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>;
<span class="hljs-title function_">notify</span>(
  <span class="hljs-title function_">t</span>(<span class="hljs-string">&quot;notifications.generatingCaption&quot;</span>) || <span class="hljs-string">&quot;Generating...&quot;</span>,
  <span class="hljs-string">&quot;info&quot;</span>,
  group,
  <span class="hljs-string">&quot;spinner&quot;</span>,
);

<span class="hljs-keyword">await</span> llm.<span class="hljs-title function_">generateStream</span>(request, {
  <span class="hljs-attr">onStep</span>: <span class="hljs-function">(<span class="hljs-params">_i, text</span>) =&gt;</span> <span class="hljs-title function_">setOutput</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + text),
  <span class="hljs-attr">onComplete</span>: <span class="hljs-title function_">async</span> (final) =&gt; {
    <span class="hljs-title function_">setOutput</span>(<span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> (p || <span class="hljs-string">&quot;&quot;</span>) + final);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">clipboard</span>?.<span class="hljs-title function_">writeText</span>(final);
      <span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Generation complete (copied)&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, group);
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Generation complete&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, group);
    }
  },
  <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> <span class="hljs-title function_">notify</span>(message || <span class="hljs-string">&quot;Generation failed&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>, group),
});

<span class="hljs-comment">// Batch mode example</span>
<span class="hljs-keyword">const</span> batchGroup = <span class="hljs-string">`diffusion-batch-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>;
<span class="hljs-title function_">notify</span>(<span class="hljs-string">`Starting batch (<span class="hljs-subst">${items.length}</span>)`</span>, <span class="hljs-string">&quot;info&quot;</span>, batchGroup, <span class="hljs-string">&quot;spinner&quot;</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; items.<span class="hljs-property">length</span>; i++) {
  <span class="hljs-keyword">const</span> itemGroup = <span class="hljs-string">`<span class="hljs-subst">${batchGroup}</span>:<span class="hljs-subst">${i}</span>`</span>;
  <span class="hljs-title function_">notify</span>(<span class="hljs-string">`Item <span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>...`</span>, <span class="hljs-string">&quot;info&quot;</span>, itemGroup, <span class="hljs-string">&quot;spinner&quot;</span>);
}</code></pre><h3>NLWeb Integration Notifications</h3>
<p>When NLWeb integration is enabled, the system may display notifications for<br>router selections and tool executions. These notifications help users understand<br>what tools are being suggested and executed based on their natural language<br>queries:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Router selection notifications (optional)</span>
<span class="hljs-title function_">notify</span>(
  <span class="hljs-string">&quot;Analyzing query for tool suggestions...&quot;</span>,
  <span class="hljs-string">&quot;info&quot;</span>,
  <span class="hljs-string">&quot;nlweb-router&quot;</span>,
  <span class="hljs-string">&quot;info&quot;</span>,
);

<span class="hljs-comment">// Tool execution notifications</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Executing git status...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, <span class="hljs-string">&quot;nlweb-tools&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Git status completed&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, <span class="hljs-string">&quot;nlweb-tools&quot;</span>);

<span class="hljs-comment">// Error notifications for failed tool suggestions</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;No suitable tools found for query&quot;</span>, <span class="hljs-string">&quot;warning&quot;</span>, <span class="hljs-string">&quot;nlweb-router&quot;</span>);

<span class="hljs-comment">// Tool execution progress</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Processing image captions...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, <span class="hljs-string">&quot;nlweb-tools&quot;</span>, <span class="hljs-string">&quot;spinner&quot;</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Caption generation complete&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, <span class="hljs-string">&quot;nlweb-tools&quot;</span>);</code></pre><p>The NLWeb integration uses specific notification groups (<code>nlweb-router</code> and<br><code>nlweb-tools</code>) to organize related notifications and allow users to dismiss them<br>as a group when needed.</p>
<h3>TTS and Crawl Integration Notifications</h3>
<p>The TTS and Crawl integration system provides comprehensive progress tracking<br>through notifications for the complete pipeline from URL input to audio<br>playback. These notifications help users understand the current stage of<br>processing and any issues that arise:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Crawl progress notifications</span>
<span class="hljs-keyword">const</span> crawlGroup = <span class="hljs-string">`crawl-<span class="hljs-subst">${url}</span>`</span>;
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Starting web crawl...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, crawlGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// Crawl progress updates (from SSE stream)</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Crawling webpage...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, crawlGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">25</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Extracting content...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, crawlGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">75</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Crawl completed&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, crawlGroup);

<span class="hljs-comment">// Summarization progress notifications</span>
<span class="hljs-keyword">const</span> summaryGroup = <span class="hljs-string">`summary-<span class="hljs-subst">${summaryId}</span>`</span>;
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Summarizing content...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, summaryGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// Summarization progress updates</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Cleaning markdown...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, summaryGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">20</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Generating summary...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, summaryGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">60</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Creating outline...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, summaryGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">80</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Summary completed&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, summaryGroup);

<span class="hljs-comment">// TTS synthesis notifications</span>
<span class="hljs-keyword">const</span> ttsGroup = <span class="hljs-string">`tts-<span class="hljs-subst">${summaryId}</span>`</span>;
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Synthesizing speech...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, ttsGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// TTS progress updates (for chunked synthesis)</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Processing text chunks...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, ttsGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">30</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Generating audio...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, ttsGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">70</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;TTS completed&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, ttsGroup);

<span class="hljs-comment">// Audio ingestion notifications</span>
<span class="hljs-keyword">const</span> ingestGroup = <span class="hljs-string">`ingest-<span class="hljs-subst">${audioId}</span>`</span>;
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Ingesting audio...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, ingestGroup, <span class="hljs-string">&quot;spinner&quot;</span>);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Audio ingested successfully&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, ingestGroup);

<span class="hljs-comment">// Error notifications for each stage</span>
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Crawl failed: URL not accessible&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>, crawlGroup);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Summarization failed: Content too large&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>, summaryGroup);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;TTS failed: Backend unavailable&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>, ttsGroup);
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Ingestion failed: File not found&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>, ingestGroup);

<span class="hljs-comment">// Batch processing notifications</span>
<span class="hljs-keyword">const</span> batchGroup = <span class="hljs-string">`batch-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>;
<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Processing 5 URLs...&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, batchGroup, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">0</span>);

<span class="hljs-comment">// Individual item progress within batch</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; urls.<span class="hljs-property">length</span>; i++) {
  <span class="hljs-keyword">const</span> itemGroup = <span class="hljs-string">`<span class="hljs-subst">${batchGroup}</span>:<span class="hljs-subst">${i}</span>`</span>;
  <span class="hljs-title function_">notify</span>(<span class="hljs-string">`URL <span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>: Crawling...`</span>, <span class="hljs-string">&quot;info&quot;</span>, itemGroup, <span class="hljs-string">&quot;spinner&quot;</span>);
  <span class="hljs-comment">// ... processing ...</span>
  <span class="hljs-title function_">notify</span>(<span class="hljs-string">`URL <span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>: Completed`</span>, <span class="hljs-string">&quot;success&quot;</span>, itemGroup);
}

<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Batch processing completed&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, batchGroup);</code></pre><p>The TTS and Crawl integration uses hierarchical notification groups to organize<br>related operations:</p>
<ul>
<li><code>crawl-{url}</code>: Crawl-specific notifications</li>
<li><code>summary-{summaryId}</code>: Summarization-specific notifications</li>
<li><code>tts-{summaryId}</code>: TTS synthesis notifications</li>
<li><code>ingest-{audioId}</code>: Audio ingestion notifications</li>
<li><code>batch-{timestamp}</code>: Batch processing notifications with item subgroups</li>
</ul>
<p>This grouping allows users to track progress at multiple levels and dismiss<br>related notifications together when operations complete.</p>
<h3>RAG Ingest and Progress Notifications</h3>
<p>When consuming NDJSON progress from the RAG ingestion endpoints, use a stable<br>notification <code>group</code> and update it as events arrive. Prefer a spinner icon and<br>optional <code>progress</code> percentage derived from <code>processed/total</code>.</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> { useAppContext } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;~/contexts/app&quot;</span>;
<span class="hljs-keyword">import</span> { useRAG } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;~/composables/useRAG&quot;</span>;

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">useAppContext</span>();
<span class="hljs-keyword">const</span> rag = <span class="hljs-title function_">useRAG</span>();

<span class="hljs-keyword">const</span> group = <span class="hljs-string">&quot;rag-ingest&quot;</span>;
app.<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Starting ingest…&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, group, <span class="hljs-string">&quot;spinner&quot;</span>, <span class="hljs-number">0</span>);

<span class="hljs-keyword">await</span> rag.<span class="hljs-title function_">ingestDocuments</span>(
  [{ <span class="hljs-attr">source</span>: <span class="hljs-string">&quot;manual&quot;</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">&quot;Some text&quot;</span> }],
  <span class="hljs-string">&quot;mxbai-embed-large&quot;</span>,
  <span class="hljs-function">(<span class="hljs-params">evt</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> processed = evt.<span class="hljs-property">processed</span> ?? <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> total = evt.<span class="hljs-property">total</span> ?? <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> percent =
      total &gt; <span class="hljs-number">0</span> ? <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>((processed / total) * <span class="hljs-number">100</span>) : <span class="hljs-literal">undefined</span>;
    app.<span class="hljs-title function_">notify</span>(
      <span class="hljs-string">`Ingest <span class="hljs-subst">${processed}</span>/<span class="hljs-subst">${total}</span>`</span>,
      <span class="hljs-string">&quot;info&quot;</span>,
      group,
      <span class="hljs-string">&quot;spinner&quot;</span>,
      percent,
    );
    <span class="hljs-keyword">if</span> (evt.<span class="hljs-property">type</span> === <span class="hljs-string">&quot;error&quot;</span>) {
      app.<span class="hljs-title function_">notify</span>(evt.<span class="hljs-property">error</span> || <span class="hljs-string">&quot;Ingest error&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>, group);
    }
  },
);

app.<span class="hljs-title function_">notify</span>(<span class="hljs-string">&quot;Ingest complete&quot;</span>, <span class="hljs-string">&quot;success&quot;</span>, group);</code></pre><p>For CLIP image ingestion, reuse the same approach and group (or a<br>modality‑specific group like <code>rag-ingest-clip</code>). On completion, replace the<br>spinner with a success or error toast.</p>
<h2>Features</h2>
<hr>
<p>The notification system supports several notification types including error<br>messages for failures, success notifications for completed operations, info<br>messages for general updates, and warning notifications for cautionary alerts.<br>Each type is visually distinct and appropriately styled.</p>
<p>Progress tracking is a key feature, allowing notifications to display progress<br>indicators that automatically update as operations proceed. Users can cancel<br>in-progress operations when supported.</p>
<p>Notifications can be grouped together logically, with the ability to replace or<br>update existing notifications in a group. This enables batch operations like<br>dismissing all related notifications at once.</p>
<p>The system is built with accessibility in mind, implementing proper ARIA roles<br>and labels for screen readers. Notifications can be navigated and dismissed<br>using the keyboard for full accessibility support.</p>
<p>Smooth animations enhance the user experience, with enter/exit transitions,<br>progress indicator animations, and subtle hover effects that provide visual<br>feedback without being distracting.</p>
<h2>Best Practices</h2>
<hr>
<p>When creating notification messages, keep the content concise while ensuring it<br>provides actionable information. Choose the appropriate notification type to<br>match the message severity and purpose.</p>
<p>Different notification types have recommended display durations - success and<br>info messages typically show for 3 seconds, while errors and warnings remain<br>visible for 5 seconds. Progress notifications stay until the operation<br>completes.</p>
<p>Use notification grouping judiciously to organize related operations together.<br>Update existing notifications rather than creating new ones when possible, and<br>avoid spamming users with too many notifications at once.</p>
<p>For long-running operations, show progress indicators that update frequently to<br>keep users informed. Ensure progress notifications can be cancelled when the<br>underlying operation supports cancellation.</p>
<p>Keep in mind auto-dismiss behavior in the implementation: non-error<br>notifications without a spinner auto-dismiss after about three seconds, while<br>errors and spinner notifications stay until dismissed or updated. Hovering a<br>notification pauses auto-dismiss and resets the timer when hover ends.</p>
<p>Prefer <code>group</code> updates over multiple separate toasts for streamed or batch<br>processes so the UI remains calm and readable.</p>
<h2>Implementation Details</h2>
<hr>
<p>The notification system is implemented using SolidJS&#39;s fine-grained reactivity:</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Creating notifications</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createNotification</span> = (<span class="hljs-params"><span class="hljs-attr">notification</span>: <span class="hljs-title class_">NotificationProps</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> id = <span class="hljs-title function_">generateId</span>();
  notifications.<span class="hljs-title function_">set</span>(id, { ...notification, id });
  <span class="hljs-keyword">return</span> id;
};

<span class="hljs-comment">// Updating notifications</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">updateNotification</span> = (<span class="hljs-params">
  <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>,
  <span class="hljs-attr">updates</span>: <span class="hljs-title class_">Partial</span>&lt;<span class="hljs-title class_">NotificationProps</span>&gt;,
</span>) =&gt; {
  <span class="hljs-keyword">const</span> notification = notifications.<span class="hljs-title function_">get</span>(id);
  <span class="hljs-keyword">if</span> (notification) {
    notifications.<span class="hljs-title function_">set</span>(id, { ...notification, ...updates });
  }
};

<span class="hljs-comment">// Removing notifications</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">removeNotification</span> = (<span class="hljs-params"><span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span></span>) =&gt; {
  notifications.<span class="hljs-title function_">delete</span>(id);
};</code></pre><h2>Customization</h2>
<hr>
<p>The notification system offers several customization options. The visual<br>appearance can be adjusted using CSS variables to match the application&#39;s theme<br>and styling needs. Component props provide control over notification behavior<br>and interactions. Global defaults for the notification system can be configured<br>through the app context settings to ensure consistent behavior across the<br>application.</p>
<p>Theme variables commonly used by notifications include <code>--card-bg</code>,<br><code>--text-primary</code>, <code>--border-color</code>, <code>--accent</code>, and semantic color tokens for<br>each variant such as <code>--info</code>, <code>--success</code>, <code>--warning</code>, and <code>--error</code> along<br>with their <code>-bg</code> and <code>-text</code> counterparts. See the theming documentation for<br>guidance.</p>
<h2>Accessibility</h2>
<hr>
<p>Notifications use appropriate ARIA semantics to be announced without stealing<br>focus. The component renders a container with <code>role=&quot;alert&quot;</code> and<br><code>aria-live=&quot;polite&quot;</code>, and the progress indicator uses <code>role=&quot;progressbar&quot;</code> with<br><code>aria-valuenow</code>, <code>aria-valuemin</code>, and <code>aria-valuemax</code>.</p>
<p>For non-urgent updates, a <code>status</code> live region (<code>role=&quot;status&quot;</code>,<br><code>aria-live=&quot;polite&quot;</code>) is typically sufficient; for high-urgency errors, <code>alert</code><br>can be used to ensure announcement. Avoid interrupting users or moving focus.<br>Provide a visible, focusable close button with an <code>aria-label</code>; the<br>implementation shows the close button on error or on hover for other types. Keep<br>messages short and avoid flooding the live region by updating the same group<br>rather than emitting many new toasts.</p>
<p>These align with WAI-ARIA guidance for live regions and toast notifications in<br>modern web apps.</p>
<h2>Testing</h2>
<hr>
<p>There is a dedicated module (<code>src/modules/notifications.ts</code>) with accompanying<br>tests (<code>src/modules/notifications.test.ts</code>) that validate creation, grouping,<br>and removal behaviors at the data level. When adding new functionality, mirror<br>logic in the module and extend tests to cover default types and timestamping,<br>group-based clearing and in-place updates, and unique ID generation and removal<br>flows.</p>
</div>
    </div>
  </main>
  <footer class="docs-footer"><p>&copy; 2024 Reynard Documentation Test. Built with ❤️ using SolidJS.</p></footer>
</body>
</html>