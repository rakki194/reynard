<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>reynard-ai-shared - Reynard Documentation Test</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../highlight.css">
  <link rel="icon" href="/favicon.ico">
</head>
<body>
  <nav class="docs-nav">
    <div class="nav-brand"><a href="../index.html">Reynard Documentation Test</a></div>
    <div class="nav-links"><a href="../index.html">Home</a><a href="../api.html">API Reference</a></div>
  </nav>
  <main class="docs-main">
    <div class="docs-content">
      <h1>reynard-ai-shared</h1>
      <div class="markdown-content"><h1>reynard-ai-shared</h1>
<blockquote>
<p><strong>The Foundation of Reynard&#39;s AI/ML Ecosystem</strong> ü¶ä</p>
</blockquote>
<p>Shared utilities, base classes, and types for all AI/ML packages in the Reynard framework. This package provides the essential building blocks for building consistent, interoperable AI/ML services.</p>
<h2>‚ú® Features</h2>
<h3>üéØ <strong>Base Classes</strong></h3>
<ul>
<li><strong>BaseAIService</strong>: Abstract base class for all AI/ML services with lifecycle management, health monitoring, and error handling</li>
<li><strong>BaseModel</strong>: Abstract base class for all AI/ML models with loading, unloading, and configuration management</li>
<li><strong>ServiceRegistry</strong>: Central registry for managing AI/ML services with dependency resolution</li>
<li><strong>ModelRegistry</strong>: Central registry for managing AI/ML models with loading coordination</li>
</ul>
<h3>üõ†Ô∏è <strong>Utility Classes</strong></h3>
<ul>
<li><strong>ValidationUtils</strong>: Comprehensive validation utilities for data and configuration</li>
<li><strong>PerformanceMonitor</strong>: Performance monitoring and metrics collection</li>
<li><strong>ErrorUtils</strong>: Error handling, retry logic, and logging utilities</li>
<li><strong>DataUtils</strong>: Data processing, transformation, and formatting utilities</li>
<li><strong>ProgressTracker</strong>: Progress tracking for long-running operations</li>
</ul>
<h3>üìä <strong>Type System</strong></h3>
<ul>
<li><strong>Service Types</strong>: ServiceStatus, ServiceHealth, ServiceHealthInfo, ServiceConfig</li>
<li><strong>Model Types</strong>: ModelStatus, ModelType, ModelInfo, ModelConfig</li>
<li><strong>AI/ML Types</strong>: CaptionTask, CaptionResult, EmbeddingResult, SearchResult</li>
<li><strong>Error Types</strong>: AIError, ModelError, ServiceError with context and codes</li>
<li><strong>Utility Types</strong>: AsyncResult, ProgressCallback, ValidationResult</li>
</ul>
<h2>üì¶ Installation</h2>
<pre><code class="hljs language-bash">npm install reynard-ai-shared</code></pre><h2>üöÄ Quick Start</h2>
<h3>Basic Service Implementation</h3>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">BaseAIService</span>,
  <span class="hljs-title class_">ServiceConfig</span>,
  <span class="hljs-title class_">ServiceHealthInfo</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;reynard-ai-shared&quot;</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAIService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">BaseAIService</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">ServiceConfig</span> = {
      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;my-ai-service&quot;</span>,
      <span class="hljs-attr">dependencies</span>: [<span class="hljs-string">&quot;database-service&quot;</span>],
      <span class="hljs-attr">startupPriority</span>: <span class="hljs-number">50</span>,
      <span class="hljs-attr">autoStart</span>: <span class="hljs-literal">true</span>,
    };
    <span class="hljs-variable language_">super</span>(config);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initialize</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// Initialize your service</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Initializing MyAI Service...&quot;</span>);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">healthCheck</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ServiceHealthInfo</span>&gt; {
    <span class="hljs-comment">// Perform health check</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">status</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span>,
      <span class="hljs-attr">health</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">health</span>,
      <span class="hljs-attr">lastCheck</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
      <span class="hljs-attr">uptime</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">startupTime</span> ? <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startupTime</span>.<span class="hljs-title function_">getTime</span>() : <span class="hljs-number">0</span>,
      <span class="hljs-attr">memoryUsage</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">cpuUsage</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">errorCount</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">metadata</span>: {},
    };
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">shutdown</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// Clean up resources</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Shutting down MyAI Service...&quot;</span>);
  }
}

<span class="hljs-comment">// Register and use the service</span>
<span class="hljs-keyword">import</span> { getServiceRegistry } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;reynard-ai-shared&quot;</span>;

<span class="hljs-keyword">const</span> registry = <span class="hljs-title function_">getServiceRegistry</span>();
<span class="hljs-keyword">const</span> service = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyAIService</span>();
registry.<span class="hljs-title function_">register</span>(service);
<span class="hljs-keyword">await</span> service.<span class="hljs-title function_">start</span>();</code></pre><h3>Basic Model Implementation</h3>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">BaseModel</span>,
  <span class="hljs-title class_">ModelType</span>,
  <span class="hljs-title class_">ModelInfo</span>,
  <span class="hljs-title class_">ModelConfig</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;reynard-ai-shared&quot;</span>;

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAIModel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">BaseModel</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-variable language_">super</span>(
      <span class="hljs-string">&quot;my-ai-model&quot;</span>,
      <span class="hljs-string">&quot;My AI Model&quot;</span>,
      <span class="hljs-title class_">ModelType</span>.<span class="hljs-property">CAPTION</span>,
      <span class="hljs-string">&quot;1.0.0&quot;</span>,
      <span class="hljs-string">&quot;A sample AI model for caption generation&quot;</span>,
      {
        <span class="hljs-attr">threshold</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;number&quot;</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">0.5</span> },
        <span class="hljs-attr">maxLength</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;number&quot;</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">512</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">256</span> },
      },
    );
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">load</span>(<span class="hljs-attr">config</span>?: <span class="hljs-title class_">ModelConfig</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// Load your model</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Loading MyAI Model...&quot;</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_size</span> = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">100</span>; <span class="hljs-comment">// 100MB</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_memoryUsage</span> = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">50</span>; <span class="hljs-comment">// 50MB</span>
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">unload</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-comment">// Unload your model</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Unloading MyAI Model...&quot;</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_memoryUsage</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">isAvailable</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {
    <span class="hljs-comment">// Check if model is available</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getModelInfo</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ModelInfo</span>&gt; {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span>,
      <span class="hljs-attr">version</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">version</span>,
      <span class="hljs-attr">description</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">description</span>,
      <span class="hljs-attr">status</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">size</span>,
      <span class="hljs-attr">memoryUsage</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">memoryUsage</span>,
      <span class="hljs-attr">gpuAcceleration</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">gpuAcceleration</span>,
      <span class="hljs-attr">supportedFormats</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">supportedFormats</span>,
      <span class="hljs-attr">configSchema</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">configSchema</span>,
      <span class="hljs-attr">metadata</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">metadata</span>,
      <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
      <span class="hljs-attr">updatedAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),
    };
  }
}

<span class="hljs-comment">// Register and use the model</span>
<span class="hljs-keyword">import</span> { getModelRegistry } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;reynard-ai-shared&quot;</span>;

<span class="hljs-keyword">const</span> registry = <span class="hljs-title function_">getModelRegistry</span>();
<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyAIModel</span>();
registry.<span class="hljs-title function_">register</span>(model);
<span class="hljs-keyword">await</span> model.<span class="hljs-title function_">loadModel</span>({ <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.7</span> });</code></pre><h3>Using Utilities</h3>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">ValidationUtils</span>,
  <span class="hljs-title class_">PerformanceMonitor</span>,
  <span class="hljs-title class_">ErrorUtils</span>,
  <span class="hljs-title class_">DataUtils</span>,
  <span class="hljs-title class_">ProgressTracker</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;reynard-ai-shared&quot;</span>;

<span class="hljs-comment">// Validation</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-title class_">ValidationUtils</span>.<span class="hljs-title function_">validateValue</span>(<span class="hljs-string">&quot;test@example.com&quot;</span>, {
  <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;string&quot;</span>,
  <span class="hljs-attr">pattern</span>: <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>,
  <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
});

<span class="hljs-comment">// Performance monitoring</span>
<span class="hljs-keyword">const</span> timer = <span class="hljs-title class_">PerformanceMonitor</span>.<span class="hljs-title function_">startTimer</span>(<span class="hljs-string">&quot;my-operation&quot;</span>);
<span class="hljs-comment">// ... do work ...</span>
<span class="hljs-keyword">const</span> metrics = <span class="hljs-title function_">timer</span>();

<span class="hljs-comment">// Error handling with retry</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ErrorUtils</span>.<span class="hljs-title function_">retry</span>(
  <span class="hljs-title function_">async</span> () =&gt; {
    <span class="hljs-comment">// Risky operation</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>();
  },
  <span class="hljs-number">3</span>, <span class="hljs-comment">// max retries</span>
  <span class="hljs-number">1000</span>, <span class="hljs-comment">// base delay</span>
);

<span class="hljs-comment">// Data processing</span>
<span class="hljs-keyword">const</span> cleanTags = <span class="hljs-title class_">DataUtils</span>.<span class="hljs-title function_">cleanTags</span>([<span class="hljs-string">&quot;tag1&quot;</span>, <span class="hljs-string">&quot;TAG2&quot;</span>, <span class="hljs-string">&quot;tag1&quot;</span>, <span class="hljs-string">&quot;tag3&quot;</span>]);
<span class="hljs-keyword">const</span> formattedSize = <span class="hljs-title class_">DataUtils</span>.<span class="hljs-title function_">formatFileSize</span>(<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">5</span>); <span class="hljs-comment">// &quot;5.00 MB&quot;</span>

<span class="hljs-comment">// Progress tracking</span>
<span class="hljs-keyword">const</span> tracker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProgressTracker</span>(<span class="hljs-number">100</span>, <span class="hljs-function">(<span class="hljs-params">progress, message</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Progress: <span class="hljs-subst">${progress.toFixed(<span class="hljs-number">1</span>)}</span>% - <span class="hljs-subst">${message}</span>`</span>);
});

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
  <span class="hljs-comment">// Do work</span>
  tracker.<span class="hljs-title function_">increment</span>(<span class="hljs-number">1</span>, <span class="hljs-string">`Processing item <span class="hljs-subst">${i}</span>`</span>);
}</code></pre><h2>üèóÔ∏è Architecture</h2>
<h3>Service Lifecycle</h3>
<ol>
<li><strong>Registration</strong>: Services are registered with the ServiceRegistry</li>
<li><strong>Initialization</strong>: Services are initialized in dependency order</li>
<li><strong>Health Monitoring</strong>: Automatic health checks every 30 seconds</li>
<li><strong>Shutdown</strong>: Graceful shutdown with cleanup</li>
</ol>
<h3>Model Lifecycle</h3>
<ol>
<li><strong>Registration</strong>: Models are registered with the ModelRegistry</li>
<li><strong>Loading</strong>: Models are loaded on-demand or preloaded</li>
<li><strong>Usage</strong>: Models are used for inference operations</li>
<li><strong>Unloading</strong>: Models are unloaded to free memory</li>
</ol>
<h3>Error Handling</h3>
<ul>
<li><strong>Standardized Errors</strong>: AIError, ModelError, ServiceError with context</li>
<li><strong>Retry Logic</strong>: Exponential backoff with configurable retries</li>
<li><strong>Error Logging</strong>: Structured error logging with context</li>
<li><strong>Graceful Degradation</strong>: Services continue operating despite errors</li>
</ul>
<h2>üîß Configuration</h2>
<h3>Service Configuration</h3>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ServiceConfig</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">dependencies</span>?: <span class="hljs-built_in">string</span>[];
  <span class="hljs-attr">requiredPackages</span>?: <span class="hljs-built_in">string</span>[];
  <span class="hljs-attr">startupPriority</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">healthCheckInterval</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">autoStart</span>?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">config</span>?: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt;;
}</code></pre><h3>Model Configuration</h3>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ModelConfig</span> {
  <span class="hljs-attr">threshold</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">maxLength</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">temperature</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">batchSize</span>?: <span class="hljs-built_in">number</span>;
  <span class="hljs-attr">gpuAcceleration</span>?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-attr">postProcessing</span>?: <span class="hljs-title class_">PostProcessingRules</span>;
  [<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">any</span>;
}</code></pre><h2>üß™ Testing</h2>
<pre><code class="hljs language-bash"><span class="hljs-comment"># Run tests</span>
npm <span class="hljs-built_in">test</span>

<span class="hljs-comment"># Run tests with coverage</span>
npm run <span class="hljs-built_in">test</span>:coverage

<span class="hljs-comment"># Run tests in watch mode</span>
npm run <span class="hljs-built_in">test</span>:watch</code></pre><h2>üìö API Reference</h2>
<h3>BaseAIService</h3>
<ul>
<li><code>start()</code>: Start the service</li>
<li><code>stop()</code>: Stop the service</li>
<li><code>restart()</code>: Restart the service</li>
<li><code>healthCheck()</code>: Perform health check</li>
<li><code>getServiceInfo()</code>: Get comprehensive service information</li>
<li><code>updateConfig(config)</code>: Update service configuration</li>
</ul>
<h3>BaseModel</h3>
<ul>
<li><code>loadModel(config?)</code>: Load the model</li>
<li><code>unloadModel()</code>: Unload the model</li>
<li><code>reloadModel(config?)</code>: Reload the model</li>
<li><code>isAvailable()</code>: Check if model is available</li>
<li><code>getModelInfo()</code>: Get model information</li>
<li><code>updateConfig(config)</code>: Update model configuration</li>
</ul>
<h3>ValidationUtils</h3>
<ul>
<li><code>validateValue(value, schema)</code>: Validate a single value</li>
<li><code>validateMultiple(values, schema)</code>: Validate multiple values</li>
<li><code>validateEmail(email)</code>: Validate email format</li>
<li><code>validateUrl(url)</code>: Validate URL format</li>
<li><code>validateFilePath(path)</code>: Validate file path</li>
</ul>
<h3>PerformanceMonitor</h3>
<ul>
<li><code>startTimer(operation)</code>: Start timing an operation</li>
<li><code>trackOperation(operation, fn, metadata)</code>: Track an operation</li>
<li><code>getMemoryUsage()</code>: Get memory usage information</li>
<li><code>getMetrics(operation?)</code>: Get performance metrics</li>
<li><code>getAveragePerformance(operation)</code>: Get average performance</li>
</ul>
<h2>ü§ù Contributing</h2>
<ol>
<li>Fork the repository</li>
<li>Create a feature branch</li>
<li>Make your changes</li>
<li>Add tests</li>
<li>Submit a pull request</li>
</ol>
<h2>üìÑ License</h2>
<p>MIT License - see LICENSE file for details.</p>
<h2>ü¶ä Reynard Framework</h2>
<p>This package is part of the Reynard framework - a cunning SolidJS framework with modular architecture. Learn more at <a href="https://reynard.dev">reynard.dev</a>.</p>
</div>
    </div>
  </main>
  <footer class="docs-footer"><p>&copy; 2024 Reynard Documentation Test. Built with ‚ù§Ô∏è using SolidJS.</p></footer>
</body>
</html>