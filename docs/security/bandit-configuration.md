# Bandit Security Scanner Configuration

_Generated by Active-Counselor-30 on 2025-09-17_

## Overview

Bandit is a security linter designed to identify common security issues in Python code. This document describes the optimized configuration for the Reynard monorepo, ensuring comprehensive security scanning across all Python packages while maintaining reasonable performance.

## Current Configuration

The Bandit configuration is defined in `bandit.yaml` at the project root and includes:

### Directory Exclusions

The following directories are excluded from scanning as they don't contain source code:

- `node_modules` - Node.js dependencies
- `venv`, `.venv`, `backend/venv` - Python virtual environments
- `third_party` - Third-party code (as per project memory)
- `.git` - Git repository data
- `__pycache__` - Python bytecode cache directories
- `.pytest_cache`, `htmlcov` - Test and coverage artifacts
- `dist`, `build` - Build artifacts
- `.mypy_cache`, `.ruff_cache` - Linter caches

### Test Exclusions

The following security tests are skipped as they're acceptable in our context:

- `B101` - assert_used (allow in tests)
- `B601` - paramiko_calls (allow in security tools)
- `B603` - subprocess_without_shell_equals_true (allow in security tools)
- `B607` - start_process_with_partial_path (allow in security tools)
- `B104` - hardcoded_bind_all_interfaces (allow in development)

### Output Configuration

- **Format**: JSON for programmatic processing
- **Severity Threshold**: Medium and above
- **Confidence Threshold**: Medium and above
- **Line Numbers**: Included for precise issue location
- **Verbose**: Disabled for cleaner output

## Usage

### Command Line

```bash
# Run with configuration file
bandit -c bandit.yaml -r . -f json

# Run with text output
bandit -c bandit.yaml -r . -f txt

# Run specific directories
bandit -c bandit.yaml -r backend/ scripts/ fenrir/ -f json
```

### Package.json Script

The project includes a convenient npm script:

```bash
pnpm run python:security
```

This runs: `bandit -c bandit.yaml -r . -f json`

### MCP Server Integration

The Reynard MCP server provides security scanning tools:

- `scan_security` - Complete security audit including Bandit
- `scan_security_fast` - Fast security scanning (skips Bandit)
- `scan_security_full` - Comprehensive security scanning with Bandit

## Current Scan Results

Based on the latest scan (2025-09-17):

- **Total Lines Scanned**: 157,142
- **Issues Found**:
  - High: 4
  - Medium: 50
  - Low: 399
- **Confidence Distribution**:
  - High: 255
  - Medium: 187
  - Low: 11

## Best Practices

### 1. Regular Scanning

Run Bandit scans regularly as part of your development workflow:

```bash
# Pre-commit hook
pnpm run python:security

# CI/CD pipeline
bandit -c bandit.yaml -r . -f json -o bandit-results.json
```

### 2. Suppressing False Positives

For legitimate security exceptions, use the `# nosec` comment:

```python
# This is safe in our context
password = "default_password"  # nosec B105
```

### 3. Configuration Updates

When adding new Python packages or changing the project structure:

1. Update `exclude_dirs` in `bandit.yaml` if needed
2. Review `skips` list for new acceptable patterns
3. Test configuration with: `bandit -c bandit.yaml -r . -f txt`

### 4. Integration with Other Tools

Bandit works alongside other security tools in the Reynard ecosystem:

- **ESLint Security**: Frontend security scanning
- **Fenrir**: Custom security exploits and fuzzing
- **Safety**: Dependency vulnerability scanning
- **Mypy**: Type checking for security-related type issues

## Troubleshooting

### Common Issues

1. **Too many warnings**: Adjust `severity` and `confidence` thresholds
2. **Slow scanning**: Add more directories to `exclude_dirs`
3. **False positives**: Add test IDs to `skips` list
4. **Missing files**: Check `exclude_dirs` configuration

### Performance Optimization

- Exclude build artifacts and caches
- Use JSON output for programmatic processing
- Run on specific directories for focused scans
- Consider running in CI/CD for comprehensive coverage

## Web Search Results Summary

Based on current Bandit best practices (2025):

1. **Installation**: `pip install bandit`
2. **Configuration**: Use YAML files for complex setups
3. **Integration**: Works well with CI/CD pipelines
4. **Suppression**: Use `# nosec` comments for legitimate exceptions
5. **Output**: JSON format enables automated processing

## Conclusion

The current Bandit configuration provides comprehensive security scanning for the Reynard monorepo while maintaining good performance and reducing false positives. The configuration is optimized for the project's structure and development workflow.

For questions or updates to the configuration, refer to the [Bandit documentation](https://bandit.readthedocs.io/) or contact the development team.
