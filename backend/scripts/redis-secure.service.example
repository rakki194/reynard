[Unit]
Description=Redis In-Memory Data Store (Secure)
Documentation=https://redis.io/documentation
After=network.target

[Service]
Type=notify
ExecStart=/usr/bin/redis-server /etc/redis/redis.conf --supervised systemd
ExecStop=/usr/bin/redis-cli -a YOUR_SECURE_REDIS_PASSWORD_HERE shutdown
TimeoutStopSec=0
Restart=always
User=redis
Group=redis
RuntimeDirectory=redis
RuntimeDirectoryMode=0755

# Security settings
NoNewPrivileges=yes
PrivateTmp=yes
ProtectSystem=strict
ProtectHome=yes
ReadWritePaths=/var/lib/redis /var/log/redis /etc/redis/tls
ProtectKernelTunables=yes
ProtectKernelModules=yes
ProtectControlGroups=yes
RestrictRealtime=yes
RestrictSUIDSGID=yes
RemoveIPC=yes
MemoryDenyWriteExecute=yes

# Resource limits
LimitNOFILE=65535
LimitNPROC=32768

[Install]
WantedBy=multi-user.target

# Setup Instructions:
# 1. Copy this file to redis-secure.service: cp redis-secure.service.example redis-secure.service
# 2. Replace YOUR_SECURE_REDIS_PASSWORD_HERE with your actual Redis password
# 3. Update the ExecStart path to point to your redis.conf file
# 4. Install with: sudo cp redis-secure.service /etc/systemd/system/
# 5. Enable with: sudo systemctl daemon-reload && sudo systemctl enable redis-secure
